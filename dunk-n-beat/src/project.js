System.register("chunks:///Defines.js",["./_virtual/_rollupPluginBabelHelpers.js","cc"],(function(t,n){var e,i,o,A,_,s;return t({AmaEventConfirm:function(t,n){AmaSdk.MepEventEmitter.confirm(t,n)},AmaEventEmit:function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};AmaSdk.MepEventEmitter.emit(t,n)},AmaEventOn:function(t,n){AmaSdk.MepEventEmitter.on(t,n)},AmaReadContent:function(t){return AmaSdk.ContentReader.getNotes(t)},_temp:void 0,BallEvent:void 0,BackgroundEvent:void 0,ColliderGroup:void 0}),{setters:[function(t){e=t.classCallCheck},function(t){i=t.cclegacy}],execute:function(){i._RF.push({},"45f53txDeFIZrmsGVaQkohD","Defines",void 0),o=new function t(){e(this,t),this.AUDIO_DELAY=0,this.BASKET_START_Y=-1,this.BASKET_START_Z=0,this.BALL_MAX=20,this.BALL_START_Y=this.BASKET_START_Y-8,this.BALL_START_Z=this.BASKET_START_Z-25,this.BALL_MIDDLE_Y=21,this.BALL_PERCENT_MOVE_BEZIER=.85,this.BALL_FLY_TIME=2,this.BALL_INACTIVE_Y=this.BASKET_START_Y-12,this.BALL_ALIGN_DURATION=.4},t("SongInfo",(function t(){e(this,t)})),function(t){t.SCORE="OnScore",t.COMBO="OnCombo",t.COLLISION_WITH_BASKET="OnCollisionWithBasket"}(A||t("BallEvent",A={})),function(t){t.FADE="OnBackgroundFade"}(_||t("BackgroundEvent",_={})),function(t){t[t.BALL=1]="BALL",t[t.BASKET=2]="BASKET"}(s||t("ColliderGroup",s={})),i._RF.pop(),t("default",o)}}}));

System.register("chunks:///EventMgr.js",["./_virtual/_rollupPluginBabelHelpers.js","cc"],(function(t,n){var e,r,s,c,i,u,l;return{setters:[function(t){e=t.inherits,r=t.classCallCheck,s=t.possibleConstructorReturn,c=t.getPrototypeOf},function(t){i=t.cclegacy,u=t.EventTarget}],execute:function(){i._RF.push({},"f8ad5rydN9EIZ62nOSFY4Dg","EventMgr",void 0),t("EventMgr",l=function(t){function n(){return r(this,n),s(this,c(n).apply(this,arguments))}return e(n,t),n}(u)),l.instance=null,l.instance=new l,i._RF.pop()}}}));

System.register("chunks:///Ball.js",["./_virtual/_rollupPluginBabelHelpers.js","cc","./Defines.js","./EventMgr.js"],(function(e,t){var i,s,n,o,a,r,c,h,E,l,T,d,_,u,C,L,p,S,B,f,y,v,A,R,I,b,M,O,g;return e({_dec:void 0,_class:void 0,_class2:void 0,_descriptor:void 0,_temp:void 0,STATE:void 0}),{setters:[function(e){i=e.applyDecoratedDescriptor,s=e.inherits,n=e.classCallCheck,o=e.possibleConstructorReturn,a=e.getPrototypeOf,r=e.initializerDefineProperty,c=e.assertThisInitialized,h=e.createClass},function(e){E=e.cclegacy,l=e._decorator,T=e.Node,d=e.ColliderComponent,_=e.Vec3,u=e.math,C=e.PhysicsSystem,L=e.RigidBodyComponent,p=e.Component},function(e){S=e.default,B=e.ColliderGroup,f=e.BallEvent},function(e){y=e.EventMgr}],execute:function(){E._RF.push({},"50312a6y8RD8bBn7w0FtWuT","Ball",void 0),b=l.ccclass,M=l.property,function(e){e[e.INIT=0]="INIT",e[e.MOVE_BEZIER=1]="MOVE_BEZIER",e[e.MOVE_FREE=2]="MOVE_FREE",e[e.INACTIVE=3]="INACTIVE",e[e.COLLECT_NORMAL=4]="COLLECT_NORMAL",e[e.COLLECT_PERFECT=5]="COLLECT_PERFECT",e[e.COLLECT_MISS=6]="COLLECT_MISS"}(O||(O={})),v=M({type:[T]}),g=b((I=i((R=function(e){function t(){var e,i;n(this,t);for(var s=arguments.length,h=new Array(s),E=0;E<s;E++)h[E]=arguments[E];return i=o(this,(e=a(t)).call.apply(e,[this].concat(h))),r(i,"effects",I,c(i)),i.arrMoveByBezierX=[],i.arrMoveByBezierY=[S.BALL_START_Y,S.BALL_MIDDLE_Y+.5*(S.BALL_START_Y+S.BASKET_START_Y),S.BASKET_START_Y],i.arrMoveByBezierZ=[S.BALL_START_Z,S.BALL_START_Z+.8*(S.BASKET_START_Z-S.BALL_START_Z),S.BASKET_START_Z],i.state=O.INACTIVE,i.comboStage=[1,3,5,10,15],i.percent=0,i.flyTime=2,i.beatIndex=0,i.isPerfect=!0,i.isCollected=!1,i}return s(t,e),h(t,[{key:"onLoad",value:function(){this.node.active=!1}},{key:"start",value:function(){var e=this.getComponent(d);e.setGroup(B.BALL),e.setMask(B.BASKET),e.on("onCollisionEnter",this.onCollision,this),e.on("onTriggerEnter",this.onTrigger,this)}},{key:"update",value:function(e){var t=new _(this.rotateSpeed).multiplyScalar(e);switch(t.add(this.node.eulerAngles),this.state){case O.INIT:break;case O.MOVE_BEZIER:this.node.eulerAngles=t,this.UpdateMoveBezier(e),this.percent>=S.BALL_PERCENT_MOVE_BEZIER&&this.SetState(O.MOVE_FREE);break;case O.MOVE_FREE:if(this.node.eulerAngles=t,this.isCollected){this.SetState(this.isPerfect?O.COLLECT_PERFECT:O.COLLECT_NORMAL);break}this.CheckMiss()&&this.SetState(O.COLLECT_MISS);break;case O.COLLECT_MISS:case O.COLLECT_NORMAL:case O.COLLECT_PERFECT:this.node.position.y<S.BALL_INACTIVE_Y&&this.SetState(O.INACTIVE);case O.INACTIVE:}}},{key:"onCollision",value:function(e){switch(this.state){case O.MOVE_FREE:-1!=e.otherCollider.node.name.indexOf("Collider")&&(y.instance.emit(f.COLLISION_WITH_BASKET,{}),this.isPerfect=!1)}}},{key:"onTrigger",value:function(e){switch(this.state){case O.MOVE_FREE:var t=this.node.scale.x;this.node.position.x>this.basket.position.x-.5*t&&this.node.position.x<this.basket.position.x+.5*t&&(this.isCollected=!0)}}},{key:"SetState",value:function(e){switch(this.state=e,e){case O.INIT:this.isPerfect=!0,this.isCollected=!1,this.node.active=!0,this.SetState(O.MOVE_BEZIER);break;case O.MOVE_BEZIER:this.percent=0,this.rigidbody.isKinematic=!0,this.arrMoveByBezierX[0]=this.node.position.x,this.SetEffect(this.combo),this.rotateSpeed=new _(u.randomRange(300,400),u.randomRange(-100,100),u.randomRange(-100,100));break;case O.MOVE_FREE:var t=new _(this.node.position.x,S.BASKET_START_Y,S.BASKET_START_Z).subtract(this.node.position),i=(1-S.BALL_PERCENT_MOVE_BEZIER)*this.flyTime;this.rigidbody.setLinearVelocity(t.multiplyScalar(1/i).add(new _(0,Math.abs(C.instance.gravity.y),0).multiplyScalar(.5*i))),this.rigidbody.isKinematic=!1,this.rigidbody.wakeUp();break;case O.COLLECT_MISS:y.instance.emit(f.SCORE,{index:this.beatIndex,miss:!0,perfect:!1});break;case O.COLLECT_NORMAL:y.instance.emit(f.SCORE,{index:this.beatIndex,miss:!1,perfect:!1});break;case O.COLLECT_PERFECT:y.instance.emit(f.SCORE,{index:this.beatIndex,miss:!1,perfect:!0});break;case O.INACTIVE:this.rigidbody.sleep()}}},{key:"Throw",value:function(e,t,i,s,n){this.beatIndex=e,this.minX=i,this.maxX=s,this.combo=n,this.rigidbody=this.getComponent(L),this.node.setPosition(t,S.BALL_START_Y,S.BALL_START_Z),this.SetState(O.INIT)}},{key:"SetEffect",value:function(e){for(var t=-1,i=0;i<this.comboStage.length;i++)e>=this.comboStage[i]&&t++;for(var s=0;s<this.effects.length;s++)this.effects[s].active=s<=t}},{key:"IsInactive",value:function(){return this.state==O.INACTIVE}},{key:"CheckMiss",value:function(){var e=this.node.scale.x,t=this.node.position,i=new _(0,0,0);return this.rigidbody.getLinearVelocity(i),t.y<this.basket.position.y&&(t.x<this.basket.position.x-e||t.x>this.basket.position.x+e||t.z<this.basket.position.z-e||t.z>this.basket.position.z+e)||t.y<=this.basket.position.y-1||t.z<this.basket.position.z-e&&i.z<0||t.z>this.basket.position.z+e&&i.z>0||t.x<this.minX-e||t.x>this.maxX+e}},{key:"UpdateMoveBezier",value:function(e){this.percent=this.MoveToTarget(this.percent,S.BALL_PERCENT_MOVE_BEZIER,1/this.flyTime,e),this.node.setPosition(this.Bezier(this.percent,this.arrMoveByBezierX),this.Bezier(this.percent,this.arrMoveByBezierY),this.Bezier(this.percent,this.arrMoveByBezierZ))}},{key:"MoveToTarget",value:function(e,t,i,s){return i=Math.abs(i),e<t?Math.min(e+i*s,t):e>t?Math.max(e-i*s,t):e}},{key:"Bezier2P",value:function(e,t,i,s){var n=s-i+1;return n>2?(1-e)*this.Bezier2P(e,t,i,s-1)+e*this.Bezier2P(e,t,i+1,s):n>=2?(1-e)*t[i]+e*t[s]:n>=1?t[i]:0}},{key:"Bezier1P",value:function(e,t,i){return this.Bezier2P(e,t,i,t.length-1)}},{key:"Bezier",value:function(e,t){return this.Bezier2P(e,t,0,t.length-1)}}]),t}(p)).prototype,"effects",[v],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),A=R))||A,E._RF.pop(),e("default",g)}}}));

System.register("chunks:///core/Timer.js",["../_virtual/_rollupPluginBabelHelpers.js","cc"],(function(t,e){var i,s,n,r;return{setters:[function(t){i=t.createClass,s=t.classCallCheck},function(t){n=t.cclegacy}],execute:function(){n._RF.push({},"6b85cbHB39ATpO/QtAEphQG","Timer",void 0),r=function(){function t(){s(this,t),this.timer=0,this.duration=0,this.overhead=0,this.isDone=!0}return i(t,[{key:"SetDuration",value:function(t){this.timer=this.duration=t,this.overhead=0,this.isDone=!1}},{key:"AddTime",value:function(t){this.timer+=t,this.overhead=0,this.isDone=!1}},{key:"GetTimePercent",value:function(){return this.timer/this.duration}},{key:"Reset",value:function(){this.timer=this.duration,this.overhead=0,this.isDone=!1}},{key:"IsDone",value:function(){return 0==this.timer}},{key:"JustFinished",value:function(){return!(this.timer>0)&&(!this.isDone&&(this.isDone=!0,!0))}},{key:"Update",value:function(t){0!=this.timer&&(this.timer-=t,this.timer<0&&(this.overhead=-this.timer,this.timer=0))}}]),t}(),n._RF.pop(),t("default",r)}}}));

System.register("chunks:///core/Input.js",["../_virtual/_rollupPluginBabelHelpers.js","cc"],(function(t,o){var n,e,i,s,c,u,a,h,r,l,p,v,d,f,y;return t({_class:void 0,_class2:void 0,_temp:void 0}),{setters:[function(t){n=t.inherits,e=t.classCallCheck,i=t.possibleConstructorReturn,s=t.getPrototypeOf,c=t.createClass},function(t){u=t.cclegacy,a=t.Vec2,h=t.Node,r=t.Component}],execute:function(){u._RF.push({},"86a1eETgqhC7LCRoYW35gpp","Input",void 0),d=cc._decorator,f=d.ccclass,d.property,y=f((v=p=function(t){function o(){var t,n;e(this,o);for(var c=arguments.length,u=new Array(c),h=0;h<c;h++)u[h]=arguments[h];return(n=i(this,(t=s(o)).call.apply(t,[this].concat(u)))).position=new a(0,0),n.prevPosition=new a(0,0),n.delta=new a(0,0),n.isHold=!1,n}return n(o,t),c(o,[{key:"onLoad",value:function(){o.instance=this,this.node.on(h.EventType.TOUCH_START,this.onTouchStart,this),this.node.on(h.EventType.TOUCH_END,this.onTouchEnd,this),this.node.on(h.EventType.TOUCH_MOVE,this.onTouchMove,this)}},{key:"start",value:function(){}},{key:"update",value:function(t){this.isHold&&(cc.Vec2.subtract(this.delta,this.position,this.prevPosition),this.prevPosition=this.position)}},{key:"onTouchStart",value:function(t){this.position=t.touch.getLocation(),this.prevPosition=t.touch.getLocation(),this.isHold=!0}},{key:"onTouchEnd",value:function(t){this.delta=new cc.Vec2(0,0),this.isHold=!1}},{key:"onTouchMove",value:function(t){this.position=t.touch.getLocation()}}]),o}(r),p.instance=null,l=v))||l,u._RF.pop(),t("default",y)}}}));

System.register("chunks:///Basket.js",["./_virtual/_rollupPluginBabelHelpers.js","cc","./Defines.js","./EventMgr.js","./core/Input.js"],(function(e,t){var o,i,n,s,a,r,l,c,f,h,u,p,d,m,v,y,g,C,k,A,I,_,F,S,T,E,D,b,w,P,B,x,L,R,z,K,N;return e({_dec:void 0,_dec2:void 0,_dec3:void 0,_class:void 0,_class2:void 0,_descriptor:void 0,_descriptor2:void 0,_descriptor3:void 0,_temp:void 0,STATE:void 0}),{setters:[function(e){o=e.applyDecoratedDescriptor,i=e.inherits,n=e.classCallCheck,s=e.possibleConstructorReturn,a=e.getPrototypeOf,r=e.initializerDefineProperty,l=e.assertThisInitialized,c=e.createClass},function(e){f=e.cclegacy,h=e._decorator,u=e.Node,p=e.Color,d=e.ColliderComponent,m=e.lerp,v=e.clamp,y=e.tween,g=e.math,C=e.Vec3,k=e.ParticleSystemComponent,A=e.Component},function(e){I=e.default,_=e.ColliderGroup,F=e.BackgroundEvent},function(e){S=e.EventMgr},function(e){T=e.default}],execute:function(){f._RF.push({},"3392a5tZUFJAZwWtbhZA1/m","Basket",void 0),R=h.ccclass,z=h.property,function(e){e[e.INIT=0]="INIT",e[e.PLAYING=1]="PLAYING",e[e.DEAD=2]="DEAD"}(K||(K={})),E=z({type:u}),D=z({type:u}),b=z({type:[u]}),N=R((B=o((P=function(e){function t(){var e,o;n(this,t);for(var i=arguments.length,c=new Array(i),f=0;f<i;f++)c[f]=arguments[f];return o=s(this,(e=a(t)).call.apply(e,[this].concat(c))),r(o,"main",B,l(o)),r(o,"net",x,l(o)),r(o,"effects",L,l(o)),o.effectsColor=[],o}return i(t,e),c(t,[{key:"onLoad",value:function(){this.effectsColor.push(new p("#00FFFF")),this.effectsColor.push(new p("#005DFF")),this.effectsColor.push(new p("#FF4C4C")),this.effectsColor.push(new p("#FF7F45")),this.effectsColor.push(new p("#FF00FF")),this.effectsColor.push(new p("#7B00FF"))}},{key:"start",value:function(){for(var e=this.getComponentsInChildren(d),t=0;t<e.length;t++)e[t].setGroup(_.BASKET),e[t].setMask(_.BALL);S.instance.on(F.FADE,this.OnBackgroundFade,this)}},{key:"update",value:function(e){switch(this.state){case K.INIT:break;case K.PLAYING:if(T.instance.isHold){var t=m(this.node.position.x,this.node.position.x+T.instance.delta.x,e);t=v(t,this.minX,this.maxX),this.node.setPosition(t,this.node.position.y,this.node.position.z)}break;case K.DEAD:}}},{key:"SetState",value:function(e){switch(this.state=e,this.state){case K.INIT:this.node.setPosition(0,I.BASKET_START_Y,I.BASKET_START_Z);break;case K.PLAYING:break;case K.DEAD:y(this.node).to(.5,{position:{x:0,y:I.BASKET_START_Y,z:I.BASKET_START_Z}}).start()}}},{key:"Init",value:function(){this.SetState(K.INIT)}},{key:"Play",value:function(){this.SetState(K.PLAYING)}},{key:"Dead",value:function(){this.SetState(K.DEAD)}},{key:"SetLimit",value:function(e,t){this.minX=e,this.maxX=t}},{key:"Shake",value:function(e){this.main.setPosition(g.randomRange(-e.x,e.x),e.y,g.randomRange(-e.z,e.z)),y(this.main).to(1,{position:C.ZERO},{easing:"elasticOut"}).start(),this.net.setScale(1,.7,1),this.net.setPosition(g.randomRange(-.1,.1),-.6,g.randomRange(-.1,.1)),y(this.net).to(2,{position:{x:0,y:-.8,z:0},scale:{x:1,y:1,z:1}},{easing:"elasticOut"}).start()}},{key:"Flash",value:function(e){if(e)for(var t=this.effects[1].getComponentsInChildren(k),o=0;o<t.length;o++)t[o].stop(),t[o].play();else for(var i=this.effects[0].getComponentsInChildren(k),n=0;n<i.length;n++)i[n].stop(),i[n].play()}},{key:"OnBackgroundFade",value:function(e){for(var t=e.index,o=this.effects[0].getComponentsInChildren(k),i=0;i<o.length;i++)if("glow_center"==o[i].node.name||"ring"==o[i].node.name){var n=o[i].colorOverLifetimeModule.color.gradient;n.colorKeys=[{color:this.effectsColor[2*t+0],time:0},{color:this.effectsColor[2*t+1],time:1}],n.alphaKeys=[{alpha:255,time:0},{alpha:0,time:1}]}for(var s=this.effects[1].getComponentsInChildren(k),a=0;a<s.length;a++)if("lightning_center"==s[a].node.name){var r=s[a].colorOverLifetimeModule.color.gradient;r.colorKeys=[{color:p.WHITE,time:0},{color:this.effectsColor[2*t+0],time:1}],r.alphaKeys=[{alpha:255,time:0},{alpha:255,time:1}]}else if("glow_center"==s[a].node.name||"spark"==s[a].node.name)s[a].startColor.color=this.effectsColor[2*t+0];else if("ring"==s[a].node.name){var l=s[a].colorOverLifetimeModule.color.gradient;l.colorKeys=[{color:p.WHITE,time:0},{color:this.effectsColor[2*t+0],time:.46},{color:this.effectsColor[2*t+1],time:1}],l.alphaKeys=[{alpha:255,time:0},{alpha:0,time:1}]}}}]),t}(A)).prototype,"main",[E],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),x=o(P.prototype,"net",[D],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),L=o(P.prototype,"effects",[b],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),w=P))||w,f._RF.pop(),e("default",N)}}}));

System.register("chunks:///BallMgr.js",["./_virtual/_rollupPluginBabelHelpers.js","cc","./Defines.js","./EventMgr.js","./Ball.js","./core/Timer.js","./Basket.js"],(function(t,e){var i,n,s,a,o,r,l,h,c,u,f,m,d,b,v,p,y,I,T,A,k,g,w,D,x,P,_,B,L,S,G,O,C,X,N,E;return t({_dec:void 0,_dec2:void 0,_dec3:void 0,_class:void 0,_class2:void 0,_descriptor:void 0,_descriptor2:void 0,_descriptor3:void 0,_temp:void 0,STATE:void 0}),{setters:[function(t){i=t.applyDecoratedDescriptor,n=t.inherits,s=t.classCallCheck,a=t.possibleConstructorReturn,o=t.getPrototypeOf,r=t.initializerDefineProperty,l=t.assertThisInitialized,h=t.createClass,c=t.objectSpread2},function(t){u=t.cclegacy,f=t._decorator,m=t.Prefab,d=t.AudioSourceComponent,b=t.Node,v=t.instantiate,p=t.math,y=t.clamp,I=t.Component},function(t){T=t.default,A=t.BallEvent},function(t){k=t.EventMgr},function(t){g=t.default},function(t){w=t.default},function(t){D=t.default}],execute:function(){u._RF.push({},"b69cb2ma7FGN4AP/vv6f0Lr","BallMgr",void 0),C=f.ccclass,X=f.property,function(t){t[t.INIT=0]="INIT",t[t.PLAYING=1]="PLAYING",t[t.DEAD=2]="DEAD"}(N||(N={})),x=X({type:m}),P=X({type:d}),_=X({type:b}),E=C((S=i((L=function(t){function e(){var t,i;s(this,e);for(var n=arguments.length,h=new Array(n),c=0;c<n;c++)h[c]=arguments[c];return i=a(this,(t=o(e)).call.apply(t,[this].concat(h))),r(i,"ballPrefab",S,l(i)),r(i,"mainAudio",G,l(i)),r(i,"basket",O,l(i)),i.timerDelay=new w,i.balls=[],i.ballThrowOffset=[],i.ballThrowPosition=[],i.currentTime=0,i.noteIndex=0,i.beatIndex=0,i.minX=-3,i.maxX=3,i.combo=0,i}return n(e,t),h(e,[{key:"onLoad",value:function(){}},{key:"start",value:function(){if(0==this.balls.length)for(var t=0;t<T.BALL_MAX;t++){var e=v(this.ballPrefab);e.parent=this.node,e.getComponent(g).basket=this.basket,this.balls.push(e)}k.instance.on(A.SCORE,this.OnScore,this)}},{key:"update",value:function(t){switch(this.state){case N.INIT:break;case N.PLAYING:this.timerDelay.Update(t),this.timerDelay.JustFinished()&&this.mainAudio.play(),this.UpdateMakeBall(t);break;case N.DEAD:}}},{key:"SetState",value:function(t){switch(this.state=t,t){case N.INIT:this.GenerateBallThrowPosition(),this.combo=0,this.flyTime=T.BALL_FLY_TIME,this.currentTime=this.notes[this.noteIndex].time-this.flyTime;var e=Math.max(this.currentTime,0-T.AUDIO_DELAY),i=e+T.AUDIO_DELAY;this.mainAudio.clip.setCurrentTime(i),this.timerDelay.SetDuration(e-this.currentTime);break;case N.DEAD:this.mainAudio.stop()}}},{key:"Init",value:function(t){this.noteIndex=t,this.SetState(N.INIT)}},{key:"Play",value:function(){this.SetState(N.PLAYING)}},{key:"Dead",value:function(){this.SetState(N.DEAD)}},{key:"UpdateMakeBall",value:function(t){this.currentTime+=t,this.noteIndex<this.notes.length&&this.currentTime>=this.notes[this.noteIndex].time-this.flyTime&&this.Throw(this.noteIndex++)}},{key:"SetNotes",value:function(t){this.notes=t}},{key:"GetBallThrowOffset",value:function(t){var e=0==t?0:this.notes[t].time-this.notes[t-1].time,i=(e>T.BALL_ALIGN_DURATION?5*e:0)*p.randomRange(.3,1),n=this.noteIndex/this.notes.length;if(n<.5){var s=5*(.3-n);i/=y(s,1,s)}return i}},{key:"GenerateBallThrowOffset",value:function(){for(var t=0;t<this.notes.length;t++){var e=t<=this.noteIndex?0:this.GetBallThrowOffset(t);this.ballThrowOffset[t]=e}}},{key:"GenerateBallThrowPosition",value:function(){var t=this.basket.getComponent(D);this.minX=Math.max(t.minX,-3),this.maxX=Math.min(t.maxX,3),this.GenerateBallThrowOffset();for(var e=0;e<this.notes.length;e++)if(0==e||e<=this.noteIndex)this.ballThrowPosition[e]=0;else{var i=this.ballThrowOffset[e],n=this.ballThrowPosition[e-1];i*=p.randomRange(0,1)>(n-this.minX)/(this.maxX-this.minX)?1:-1,this.ballThrowPosition[e]=y(n+i,this.minX,this.maxX)}}},{key:"GetInactiveBall",value:function(){for(var t=0;t<T.BALL_MAX;t++){if(this.balls[t].getComponent(g).IsInactive())return this.balls[t]}return null}},{key:"Throw",value:function(t){var e=this.GetInactiveBall();null!=e&&e.getComponent(g).Throw(t,this.ballThrowPosition[t],this.minX,this.maxX,this.combo)}},{key:"OnScore",value:function(t){t.miss?this.combo=0:t.perfect?this.combo++:this.combo=1,this.beatIndex=t.index,k.instance.emit(A.COMBO,c({},t,{combo:this.combo,progress:this.GetPercentCompleted(),win:this.beatIndex==this.notes.length-1}))}},{key:"GetPercentCompleted",value:function(){return this.beatIndex/(this.notes.length-1)}}]),e}(I)).prototype,"ballPrefab",[x],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),G=i(L.prototype,"mainAudio",[P],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),O=i(L.prototype,"basket",[_],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),B=L))||B,u._RF.pop(),t("default",E)}}}));

System.register("chunks:///ui/Background.js",["../_virtual/_rollupPluginBabelHelpers.js","cc","../Defines.js","../EventMgr.js","../core/Timer.js"],(function(e,t){var n,r,i,o,s,c,a,u,d,l,g,h,p,f,v,k,y,B,m,_,x,I,C,b;return e({_dec:void 0,_dec2:void 0,_class:void 0,_class2:void 0,_descriptor:void 0,_temp:void 0}),{setters:[function(e){n=e.applyDecoratedDescriptor,r=e.inherits,i=e.classCallCheck,o=e.possibleConstructorReturn,s=e.getPrototypeOf,c=e.initializerDefineProperty,a=e.assertThisInitialized,u=e.createClass},function(e){d=e.cclegacy,l=e._decorator,g=e.SpriteComponent,h=e.Color,p=e.tween,f=e.Component},function(e){v=e.BackgroundEvent},function(e){k=e.EventMgr},function(e){y=e.default}],execute:function(){d._RF.push({},"1e1d6UA2yRHB6vSyJPoF+qX","Background",void 0),C=l.ccclass,b=l.property,e("Background",(B=C("Background"),m=b({type:[g]}),B((I=n((x=function(e){function t(){var e,n;i(this,t);for(var r=arguments.length,u=new Array(r),d=0;d<r;d++)u[d]=arguments[d];return n=o(this,(e=s(t)).call.apply(e,[this].concat(u))),c(n,"Backgrounds",I,a(n)),n.timer=new y,n}return r(t,e),u(t,[{key:"start",value:function(){this.timer.SetDuration(10),this.StartBg()}},{key:"update",value:function(e){this.timer.Update(e),this.timer.IsDone()&&(this.Fade(),this.timer.Reset())}},{key:"StartBg",value:function(){this.currentIndex=0;for(var e=0;e<this.Backgrounds.length;e++)e==this.currentIndex?this.Backgrounds[e].color=new h(255,255,255,255):this.Backgrounds[e].color=new h(255,255,255,0)}},{key:"UpdateBg",value:function(e){}},{key:"Fade",value:function(){var e=this.currentIndex,t=this.currentIndex+1;t>=this.Backgrounds.length&&(t=0),p(this.Backgrounds[e]).to(2,{color:{r:255,g:255,b:255,a:0}},{easing:"linear"}).start(),p(this.Backgrounds[t]).to(2,{color:{r:255,g:255,b:255,a:255}},{easing:"linear"}).start(),this.currentIndex=t,k.instance.emit(v.FADE,{index:this.currentIndex})}},{key:"GetCurrentIndex",value:function(){return this.currentIndex}}]),t}(f)).prototype,"Backgrounds",[m],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),_=x))||_)),d._RF.pop()}}}));

System.register("chunks:///ui/ProgressBar.js",["../_virtual/_rollupPluginBabelHelpers.js","cc"],(function(t,e){var r,i,s,o,n,a,c,l,u,p,h,d,f,g,v,y,S,m,_,b,C,P,R,k,z,B;return t({_dec:void 0,_dec2:void 0,_dec3:void 0,_dec4:void 0,_class:void 0,_class2:void 0,_descriptor:void 0,_descriptor2:void 0,_descriptor3:void 0,_temp:void 0}),{setters:[function(t){r=t.applyDecoratedDescriptor,i=t.inherits,s=t.classCallCheck,o=t.possibleConstructorReturn,n=t.getPrototypeOf,a=t.initializerDefineProperty,c=t.assertThisInitialized,l=t.createClass},function(t){u=t.cclegacy,p=t._decorator,h=t.SpriteComponent,d=t.Node,f=t.ParticleSystemComponent,g=t.AudioSourceComponent,v=t.Component}],execute:function(){u._RF.push({},"fe170XaqNtPUZ2519hbRDDZ","ProgressBar",void 0),z=p.ccclass,B=p.property,t("ProgressBar",(y=z("ProgressBar"),S=B({type:h}),m=B({type:[d]}),_=B({type:d}),y((P=r((C=function(t){function e(){var t,r;s(this,e);for(var i=arguments.length,l=new Array(i),u=0;u<i;u++)l[u]=arguments[u];return r=o(this,(t=n(e)).call.apply(t,[this].concat(l))),a(r,"progress",P,c(r)),a(r,"stars",R,c(r)),a(r,"musicNote",k,c(r)),r.currentStar=0,r}return i(e,t),l(e,[{key:"start",value:function(){}},{key:"SetProgress",value:function(t){if(this.progress.fillRange=t,this.musicNote.setPosition(0,270*t,0),0==t)this.Reset();else for(;t>=.3333*(this.currentStar+1)&&(this.SetStar(this.currentStar++),this.currentStar!=this.stars.length););}},{key:"SetStar",value:function(t){for(var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=this.stars[t].getComponentsInChildren(f),i=0;i<r.length;i++)r[i].stop(),e||r[i].play();e||this.stars[t].getComponent(g).play()}},{key:"Reset",value:function(){this.currentStar=0;for(var t=0;t<this.stars.length;t++)this.SetStar(t,!0)}}]),e}(v)).prototype,"progress",[S],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),R=r(C.prototype,"stars",[m],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),k=r(C.prototype,"musicNote",[_],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),b=C))||b)),u._RF.pop()}}}));

System.register("chunks:///ui/Ingame.js",["../_virtual/_rollupPluginBabelHelpers.js","cc","./ProgressBar.js"],(function(e,t){var i,o,r,n,s,a,l,c,u,p,f,d,b,h,v,g,m,y,_,S,C,w,P,z,k,x,I,T,D,B,F,j,L,R,A,G,H,N,O;return e({_dec:void 0,_dec2:void 0,_dec3:void 0,_dec4:void 0,_dec5:void 0,_dec6:void 0,_dec7:void 0,_dec8:void 0,_class:void 0,_class2:void 0,_descriptor:void 0,_descriptor2:void 0,_descriptor3:void 0,_descriptor4:void 0,_descriptor5:void 0,_descriptor6:void 0,_descriptor7:void 0,_temp:void 0}),{setters:[function(e){i=e.applyDecoratedDescriptor,o=e.inherits,r=e.classCallCheck,n=e.possibleConstructorReturn,s=e.getPrototypeOf,a=e.initializerDefineProperty,l=e.assertThisInitialized,c=e.createClass},function(e){u=e.cclegacy,p=e._decorator,f=e.Prefab,d=e.Node,b=e.LabelComponent,h=e.tween,v=e.instantiate,g=e.SpriteComponent,m=e.Color,y=e.Vec3,_=e.Component},function(e){S=e.ProgressBar}],execute:function(){u._RF.push({},"c0430wYDwtD3JkGqQ19Hnu4","Ingame",void 0),N=p.ccclass,O=p.property,e("Ingame",(C=N("Ingame"),w=O({type:f}),P=O({type:d}),z=O({type:b}),k=O({type:b}),x=O({type:S}),I=O({type:d}),T=O({type:d}),C((F=i((B=function(e){function t(){var e,i;r(this,t);for(var o=arguments.length,c=new Array(o),u=0;u<o;u++)c[u]=arguments[u];return i=n(this,(e=s(t)).call.apply(e,[this].concat(c))),a(i,"lifePrefab",F,l(i)),a(i,"lifeContainer",j,l(i)),a(i,"score",L,l(i)),a(i,"combo",R,l(i)),a(i,"progress",A,l(i)),a(i,"hint",G,l(i)),a(i,"hand",H,l(i)),i.comboText=["None","Great","Awesome","Bravo","Fantastic","Superb","Incredible"],i.lifeSprite=[],i}return o(t,e),c(t,[{key:"start",value:function(){this.hand.setPosition(-200,0,0),h(this.hand).repeatForever(h(this.hand).to(1,{position:{x:50,y:0,z:0}}).to(1,{position:{x:-50,y:0,z:0}})).start()}},{key:"update",value:function(e){}},{key:"Init",value:function(e){if(e>1&&0==this.lifeSprite.length)for(var t=60*-(e-1)/2,i=0;i<e;i++){var o=v(this.lifePrefab);o.parent=this.lifeContainer,o.setPosition(t+60*i,0,0),this.lifeSprite.push(o.getComponent(g))}this.SetLife(e)}},{key:"SetLife",value:function(e){for(var t=0;t<this.lifeSprite.length;t++)this.lifeSprite[t].color=new m(255,255,255,t<e?255:128)}},{key:"SetScore",value:function(e){this.score.string=e}},{key:"SetCombo",value:function(e){e<=0?this.combo.string="":(e>=this.comboText.length?this.combo.string=(this.comboText[this.comboText.length-1]+" +"+(e-(this.comboText.length-1))).toUpperCase():this.combo.string=this.comboText[e].toUpperCase(),this.combo.node.setScale(1.5,1.5,1.5),h(this.combo.node).stop(),h(this.combo.node).to(.5,{scale:new y(1,1,1)},{easing:"elasticOut"}).start())}},{key:"SetProgress",value:function(e){this.progress.SetProgress(e)}}]),t}(_)).prototype,"lifePrefab",[w],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),j=i(B.prototype,"lifeContainer",[P],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),L=i(B.prototype,"score",[z],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),R=i(B.prototype,"combo",[k],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),A=i(B.prototype,"progress",[x],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),G=i(B.prototype,"hint",[I],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),H=i(B.prototype,"hand",[T],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),D=B))||D)),u._RF.pop()}}}));

System.register("chunks:///GameMgr.js",["./_virtual/_rollupPluginBabelHelpers.js","cc","./Defines.js","./EventMgr.js","./core/Timer.js","./core/Input.js","./Basket.js","./BallMgr.js","./ui/Ingame.js"],(function(e,t){var i,n,s,a,o,r,l,c,h,u,v,I,g,m,d,b,f,S,p,A,R,_,w,k,O,T,y,L,C,E,N,P,D,G,M,U,Y,W,x,z,V,j,H,B,F,K;return e({_dec:void 0,_dec2:void 0,_dec3:void 0,_dec4:void 0,_dec5:void 0,_dec6:void 0,_class:void 0,_class2:void 0,_descriptor:void 0,_descriptor2:void 0,_descriptor3:void 0,_descriptor4:void 0,_descriptor5:void 0,_descriptor6:void 0,_temp:void 0,STATE:void 0}),{setters:[function(e){i=e.applyDecoratedDescriptor,n=e.inherits,s=e.classCallCheck,a=e.possibleConstructorReturn,o=e.getPrototypeOf,r=e.initializerDefineProperty,l=e.assertThisInitialized,c=e.createClass},function(e){h=e.cclegacy,u=e.AudioSourceComponent,v=e.PhysicsSystem,I=e.Vec3,g=e.game,m=e.view,d=e.loader,b=e.Component},function(e){f=e.AmaEventOn,S=e.BallEvent,p=e.AmaEventEmit,A=e.AmaReadContent,R=e.AmaEventConfirm},function(e){_=e.EventMgr},function(e){w=e.default},function(e){k=e.default},function(e){O=e.default},function(e){T=e.default},function(e){y=e.Ingame}],execute:function(){h._RF.push({},"0afcbVbyR9PZLYJkXDtYNU8","GameMgr",void 0),j=cc._decorator,H=j.ccclass,B=j.property,function(e){e[e.INIT=0]="INIT",e[e.LOADING=1]="LOADING",e[e.LOADING_ERROR=2]="LOADING_ERROR",e[e.TOUCH_TO_PLAY=3]="TOUCH_TO_PLAY",e[e.PLAYING=4]="PLAYING",e[e.WIN=5]="WIN",e[e.REVIVAL=6]="REVIVAL",e[e.RESULT=7]="RESULT",e[e.RESTART=8]="RESTART"}(F||(F={})),L=B({type:T}),C=B({type:O}),E=B({type:y}),N=B({type:u}),P=B({type:u}),D=B({type:u}),K=H((U=i((M=function(e){function t(){var e,i;s(this,t);for(var n=arguments.length,c=new Array(n),h=0;h<n;h++)c[h]=arguments[h];return i=a(this,(e=o(t)).call.apply(e,[this].concat(c))),r(i,"ballMgr",U,l(i)),r(i,"basket",Y,l(i)),r(i,"viewIngame",W,l(i)),r(i,"mainAudio",x,l(i)),r(i,"winAudio",z,l(i)),r(i,"loseAudio",V,l(i)),i.timerWin=new w,i}return n(t,e),c(t,[{key:"onLoad",value:function(){v.instance.gravity=new I(0,-40,0)}},{key:"start",value:function(){var e=this;f("start",(function(t){e.songInfo=t,e.SetState(F.LOADING)})),f("restart",(function(t){e.songInfo=t,e.Restart()})),f("background",(function(){g.pause()})),f("foreground",(function(){g.resume()})),_.instance.on(S.COMBO,this.OnCombo,this),this.timerWin.SetDuration(3),this.Init(),p("start",{songId:"CallOnMe",mp3Url:"https://laminhtruong.github.io/dunk-n-beat/songs/WeThreeKings_BiometrixRemix.mp3",levelUrl:"https://laminhtruong.github.io/dunk-n-beat/songs/WeThreeKings_BiometrixRemix.bin",duration:120,title:"Call On Me",artist:"Eric Prydz"}),console.log(m.getCanvasSize())}},{key:"update",value:function(e){switch(this.state){case F.INIT:case F.LOADING:case F.LOADING_ERROR:break;case F.TOUCH_TO_PLAY:k.instance.isHold&&this.SetState(F.PLAYING);break;case F.PLAYING:break;case F.WIN:this.timerWin.Update(e),this.timerWin.IsDone()&&this.SetState(F.RESULT)}v.instance.deltaTime=Math.min(.1,e)}},{key:"SetState",value:function(e){var t=this;switch(this.state=e,e){case F.INIT:var i=m.getCanvasSize(),n=i.width/i.height*4;this.basket.Init(),this.basket.SetLimit(-n,n),p("create"),p("load-completed");break;case F.LOADING:d.load(this.songInfo.mp3Url,(function(e,i){null==e?(t.mainAudio.clip=i,A(t.songInfo.levelUrl).then((function(e){t.ballMgr.SetNotes(e),t.SetState(F.TOUCH_TO_PLAY)})).catch((function(e){console.log(e),t.SetState(F.LOADING_ERROR)}))):(console.log(e),t.SetState(F.LOADING_ERROR))}));break;case F.LOADING_ERROR:break;case F.TOUCH_TO_PLAY:this.viewIngame.hint.active=!0,this.ballMgr.Init(this.noteIndex);break;case F.PLAYING:this.viewIngame.hint.active=!1,this.ballMgr.Play(),this.basket.Play();break;case F.WIN:this.winAudio.play(),this.ballMgr.Dead(),this.basket.Dead(),this.timerWin.Reset();break;case F.REVIVAL:this.basket.Init(),this.SetState(F.TOUCH_TO_PLAY);break;case F.RESULT:p("game-over",{score:this.score,star:this.viewIngame.progress.currentStar,crown:0,loop:0,notes:this.ballMgr.beatIndex,revise:this.revival,percent:this.ballMgr.GetPercentCompleted()});break;case F.RESTART:this.basket.Init(),this.SetState(F.TOUCH_TO_PLAY)}}},{key:"Init",value:function(){this.score=0,this.lifes=3,this.revival=0,this.noteIndex=0,this.viewIngame.Init(this.lifes),this.viewIngame.SetScore(this.score),this.viewIngame.SetCombo(0),this.viewIngame.SetProgress(0),this.viewIngame.hint.active=!1,this.SetState(F.INIT)}},{key:"Revival",value:function(){this.lifes=3,this.noteIndex=this.ballMgr.beatIndex,this.viewIngame.Init(this.lifes),this.viewIngame.SetCombo(0),this.viewIngame.SetProgress(this.ballMgr.GetPercentCompleted()),this.revival++,this.SetState(F.REVIVAL)}},{key:"Restart",value:function(){this.score=0,this.lifes=3,this.revival=0,this.noteIndex=0,this.viewIngame.Init(this.lifes),this.viewIngame.SetScore(this.score),this.viewIngame.SetCombo(0),this.viewIngame.SetProgress(0),this.SetState(F.RESTART)}},{key:"OnCombo",value:function(e){var t=this;e.miss?this.lifes>0&&(this.lifes--,this.viewIngame.SetLife(this.lifes),0==this.lifes&&(this.ballMgr.Dead(),this.basket.Dead(),this.loseAudio.play(),R("revise",(function(e){"yes"==e?t.Revival():t.SetState(F.RESULT)})))):(e.perfect?this.basket.Shake(new I(.2,-.5,.2)):this.basket.Shake(new I(.1,-.2,.1)),this.basket.Flash(e.perfect)),e.win&&this.SetState(F.WIN),this.score+=e.combo,this.viewIngame.SetScore(this.score),this.viewIngame.SetCombo(e.combo),this.viewIngame.SetProgress(e.progress)}}]),t}(b)).prototype,"ballMgr",[L],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Y=i(M.prototype,"basket",[C],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),W=i(M.prototype,"viewIngame",[E],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),x=i(M.prototype,"mainAudio",[N],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),z=i(M.prototype,"winAudio",[P],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),V=i(M.prototype,"loseAudio",[D],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),G=M))||G,h._RF.pop(),e("default",K)}}}));

System.register("chunks:///_virtual/prerequisite-imports:main",["../Defines.js","../EventMgr.js","../Ball.js","../core/Timer.js","../core/Input.js","../Basket.js","../BallMgr.js","../ui/Background.js","../ui/ProgressBar.js","../ui/Ingame.js","../GameMgr.js"],(function(n,t){return{setters:[function(n){},function(n){},function(n){},function(n){},function(n){},function(n){},function(n){},function(n){},function(n){},function(n){},function(n){}],execute:function(){}}}));

(function(r) {
  r('project:///assets/maingame/scripts/Defines.js', 'chunks:///Defines.js');
  r('project:///assets/maingame/scripts/EventMgr.js', 'chunks:///EventMgr.js');
  r('project:///assets/maingame/scripts/Ball.js', 'chunks:///Ball.js');
  r('project:///assets/maingame/scripts/core/Timer.js', 'chunks:///core/Timer.js');
  r('project:///assets/maingame/scripts/core/Input.js', 'chunks:///core/Input.js');
  r('project:///assets/maingame/scripts/Basket.js', 'chunks:///Basket.js');
  r('project:///assets/maingame/scripts/BallMgr.js', 'chunks:///BallMgr.js');
  r('project:///assets/maingame/scripts/ui/Background.js', 'chunks:///ui/Background.js');
  r('project:///assets/maingame/scripts/ui/ProgressBar.js', 'chunks:///ui/ProgressBar.js');
  r('project:///assets/maingame/scripts/ui/Ingame.js', 'chunks:///ui/Ingame.js');
  r('project:///assets/maingame/scripts/GameMgr.js', 'chunks:///GameMgr.js');
  r('virtual:///prerequisite-imports:main', 'chunks:///_virtual/prerequisite-imports:main'); 
})(function(mid, cid) {
    System.register(mid, [cid], function (_export, _context) {
    var _m;
    return {
        setters: [function(m) { _m = m; }],
        execute: function () { _export(_m); }
    };
    });
});