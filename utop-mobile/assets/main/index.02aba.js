window.__require=function t(e,i,o){function n(c,s){if(!i[c]){if(!e[c]){var a=c.split("/");if(a=a[a.length-1],!e[a]){var u="function"==typeof __require&&__require;if(!s&&u)return u(a,!0);if(r)return r(a,!0);throw new Error("Cannot find module '"+c+"'")}c=a}var p=i[c]={exports:{}};e[c][0].call(p.exports,function(t){return n(e[c][1][t]||t)},p,p.exports,t,e,i,o)}return i[c].exports}for(var r="function"==typeof __require&&__require,c=0;c<o.length;c++)n(o[c]);return n}({API:[function(t,e,i){"use strict";cc._RF.push(e,"519a1UFF4ZBy4cfQ0vO+vLe","API");var o=this&&this.__decorate||function(t,e,i,o){var n,r=arguments.length,c=r<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,i):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)c=Reflect.decorate(t,e,i,o);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(c=(r<3?n(c):r>3?n(e,i,c):n(e,i))||c);return r>3&&c&&Object.defineProperty(e,i,c),c};Object.defineProperty(i,"__esModule",{value:!0});var n=cc._decorator.ccclass,r=function(){function t(){}var e;return e=t,t.Request=function(t,e,i){var o=window.userParams;return new Promise(function(n,r){var c=new XMLHttpRequest;c.open(t,o.api+e,!0),c.setRequestHeader("Content-type","application/json"),c.onreadystatechange=function(){4==c.readyState&&(200==c.status?n(c.response):r(c.response))},c.send(i)})},t.StartGame=function(t,i,o){var n={idChannel:i||1,gamecode:t||1,sessionID:o||1};return e.Request("post","/StartGame",JSON.stringify(n))},t.EndGame=function(t,i,o){var n={idTrans:t,sessionID:i,score:o};return e.Request("post","/EndGame",JSON.stringify(n))},t.GetTime=function(){return e.Request("post","/GetTimeStamp",null)},t=e=o([n],t)}();i.default=r,cc._RF.pop()},{}],CollectibleMgr:[function(t,e,i){"use strict";cc._RF.push(e,"cc4e1VIjdNCQZWkEeLAggyG","CollectibleMgr");var o=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function o(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(o.prototype=i.prototype,new o)}}(),n=this&&this.__decorate||function(t,e,i,o){var n,r=arguments.length,c=r<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,i):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)c=Reflect.decorate(t,e,i,o);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(c=(r<3?n(c):r>3?n(e,i,c):n(e,i))||c);return r>3&&c&&Object.defineProperty(e,i,c),c};Object.defineProperty(i,"__esModule",{value:!0});var r,c=t("./Defines"),s=t("./Collectible"),a=t("./core/Timer"),u=cc._decorator,p=u.ccclass,l=u.property;(function(t){t[t.INIT=0]="INIT",t[t.PLAYING=1]="PLAYING",t[t.DEAD=2]="DEAD"})(r||(r={}));var h=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.collectiblePrefab=null,e.collectibles=[],e.timerSpawn=new a.default,e.waveIndex=0,e}return o(e,t),e.prototype.start=function(){this.timerSpawn.SetDuration(1)},e.prototype.update=function(t){if(!cc.game.isPaused())switch(this.state){case r.INIT:break;case r.PLAYING:this.timerSpawn.Update(t),this.CanSpawn()&&(this.waveIndex%5==4?this.SpawnFood(c.CollectibleType.MENU,cc.Camera.main.node.position.x+cc.winSize.width+100,cc.winSize.height/2+c.RandomInt(-150,150)):this.SpawnFood(c.RandomInt(c.CollectibleType.BOBA,c.CollectibleType.STEAK),cc.Camera.main.node.position.x+cc.winSize.width+100,cc.winSize.height/2+c.RandomInt(-150,150)),this.waveIndex++);break;case r.DEAD:}},e.prototype.SetState=function(t){switch(this.state=t,t){case r.INIT:if(0==this.collectibles.length)for(var e=0;e<c.default.COLLECTIBLE_MAX;e++){var i=cc.instantiate(this.collectiblePrefab);i.parent=this.node,i.active=!1,this.collectibles.push(i)}else for(e=0;e<c.default.COLLECTIBLE_MAX;e++)this.collectibles[e].active=!1;this.waveIndex=0;break;case r.PLAYING:case r.DEAD:}},e.prototype.Init=function(){this.SetState(r.INIT)},e.prototype.Play=function(){this.SetState(r.PLAYING)},e.prototype.Reset=function(){this.waveIndex=0;for(var t=0;t<c.default.COLLECTIBLE_MAX;t++)this.collectibles[t].active=!1},e.prototype.CanSpawn=function(){var t=this.collectibles.every(function(t){return!t.active});if(!t){var e=this.collectibles.filter(function(t){return t.active}).map(function(t){return t.position.x-cc.Camera.main.node.position.x}).sort(function(t,e){return e-t});e.length>0&&(t=e[0]<cc.winSize.width/2)}return t},e.prototype.Spawn=function(t,e,i,o){var n=this.GetInactiveCollectible();null!=n&&(n.setScale(o,o),n.getComponent(s.default).Spawn(t,e,i,0))},e.prototype.SpawnAlphaB=function(t,e,i,o){var n=this,r=c.AlphaB[t];return o+=c.default.GRID_HEIGHT*r.length/2,r.forEach(function(t,r){t.forEach(function(t,s){if(1==t){var a=i+s*c.default.GRID_WIDTH,u=o-r*c.default.GRID_HEIGHT;n.Spawn(e,a,u,.2)}})}),r[0].length*c.default.GRID_WIDTH},e.prototype.SpawnText=function(t,e,i,o){var n=this,r=i;return t.split("").forEach(function(t){" "!=t&&(i+=n.SpawnAlphaB(t,e,i,o)),i+=35}),i-r},e.prototype.SpawnSymbol=function(t,e,i,o){var n=this,r=c.Symbols[t];return o+=c.default.GRID_HEIGHT*r.length/2,r.forEach(function(t,r){t.forEach(function(t,s){if(1==t){var a=i+s*c.default.GRID_HEIGHT,u=o-r*c.default.GRID_HEIGHT;n.Spawn(e,a,u,.1)}})}),r[0].length*c.default.GRID_HEIGHT},e.prototype.SpawnFood=function(t,e,i){var o=this.SpawnText(["TRA SUA","BUN BO","BURGER","PLAN","PIZZA","MI Y","STEAK","UTOP"][t],t,e,i-90);this.Spawn(t,e+o/2,i+90,c.default.COLLECTIBLE_SCALE)},e.prototype.Dead=function(){this.SetState(r.DEAD)},e.prototype.GetInactiveCollectible=function(){for(var t=0;t<c.default.COLLECTIBLE_MAX;t++){if(this.collectibles[t].getComponent(s.default).IsHidden())return this.collectibles[t]}return null},n([l({type:cc.Prefab})],e.prototype,"collectiblePrefab",void 0),e=n([p],e)}(cc.Component);i.default=h,cc._RF.pop()},{"./Collectible":"Collectible","./Defines":"Defines","./core/Timer":"Timer"}],Collectible:[function(t,e,i){"use strict";cc._RF.push(e,"fa348NaP0ZPiLsfr/XupaJH","Collectible");var o=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function o(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(o.prototype=i.prototype,new o)}}(),n=this&&this.__decorate||function(t,e,i,o){var n,r=arguments.length,c=r<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,i):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)c=Reflect.decorate(t,e,i,o);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(c=(r<3?n(c):r>3?n(e,i,c):n(e,i))||c);return r>3&&c&&Object.defineProperty(e,i,c),c};Object.defineProperty(i,"__esModule",{value:!0});var r,c=t("./Defines"),s=cc._decorator,a=s.ccclass,u=s.property;(function(t){t[t.PLAYING=0]="PLAYING",t[t.FOLLOWING=1]="FOLLOWING",t[t.HIDE=2]="HIDE"})(r||(r={}));var p=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.animation=null,e.foods=[],e.type=c.CollectibleType.BOBA,e.speed=0,e.isCollected=!1,e}return o(e,t),e.prototype.update=function(t){switch(this.state){case r.PLAYING:var e=cc.Camera.main.node.position;this.node.setPosition(this.node.position.subtract(cc.v3(this.speed*c.default.GAME_BASE_SPEED*t,0,0))),this.node.position.x-e.x<-cc.winSize.width/2&&this.SetState(r.HIDE);break;case r.FOLLOWING:this.node.setPosition(this.node.position.lerp(this.player.node.position,.1*c.default.GAME_BASE_SPEED*t));break;case r.HIDE:}},e.prototype.onCollected=function(){this.node.active=!1},e.prototype.SetState=function(t){switch(this.state=t,t){case r.PLAYING:this.isCollected=!1,this.node.active=!0;break;case r.HIDE:this.node.active=!1}},e.prototype.SetFood=function(t){this.type=t;for(var e=0;e<this.foods.length;e++)this.foods[e].node.active=e==t},e.prototype.Spawn=function(t,e,i,o){void 0===o&&(o=0),this.speed=o,this.node.setPosition(e,i),this.node.active=!0,this.SetFood(t),this.animation.stop(),this.animation.play("idle"),this.SetState(r.PLAYING)},e.prototype.Collect=function(){this.isCollected||(this.isCollected=!0,this.animation.play("collect"),this.node.scale==c.default.COLLECTIBLE_SCALE&&this.node.getComponent(cc.AudioSource).play())},e.prototype.Follow=function(t){this.state!=r.FOLLOWING&&(this.player=t,this.SetState(r.FOLLOWING))},e.prototype.Hide=function(){this.isCollected||(this.node.active=!1)},e.prototype.IsHidden=function(){return!this.node.active},n([u({type:cc.Animation})],e.prototype,"animation",void 0),n([u({type:[cc.Sprite]})],e.prototype,"foods",void 0),e=n([a],e)}(cc.Component);i.default=p,cc._RF.pop()},{"./Defines":"Defines"}],Defines:[function(t,e,i){"use strict";cc._RF.push(e,"a49cbvPOuxAKauT+47PnPv4","Defines"),Object.defineProperty(i,"__esModule",{value:!0}),i.Symbols=i.AlphaB=i.CollectibleType=i.CollisionTag=i.GameEvent=i.RandomInt=i.Clamp=void 0,i.default=new(function(){return function(){this.GAME_BASE_SPEED=60,this.GAME_TIMEOUT=60,this.GAME_RESULT_TIMEOUT=5,this.GAME_SPEED_MIN=5,this.GAME_SPEED_MAX=7,this.COLLECTIBLE_SCALE=.8,this.COLLECTIBLE_MAX=200,this.ROCKET_MAX=5,this.GRID_WIDTH=20,this.GRID_HEIGHT=25,this.QR_REFRESH_RATE=270,this.USE_SIMPLE_FACE_DETECT=!0}}()),i.Clamp=function(t,e,i){return Math.min(Math.max(t,e),i)},i.RandomInt=function(t,e){return Math.floor(Math.random()*(e-t+1)+t)},function(t){t.TOUCH="TouchEvent",t.COLLECT_ITEM="CollectItem",t.PLAYER_HURT="PlayerHurt",t.LOSE="GameLose"}(i.GameEvent||(i.GameEvent={})),function(t){t[t.COLLECTIBLE=0]="COLLECTIBLE",t[t.ROCKET=1]="ROCKET",t[t.EVIL=2]="EVIL"}(i.CollisionTag||(i.CollisionTag={})),function(t){t[t.BOBA=0]="BOBA",t[t.BUNBO=1]="BUNBO",t[t.BURGER=2]="BURGER",t[t.PLAN=3]="PLAN",t[t.PIZZA=4]="PIZZA",t[t.SPAGHETTI=5]="SPAGHETTI",t[t.STEAK=6]="STEAK",t[t.MENU=7]="MENU"}(i.CollectibleType||(i.CollectibleType={})),i.AlphaB={A:[[0,1,1,1,0],[1,0,0,0,1],[1,1,1,1,1],[1,0,0,0,1],[1,0,0,0,1]],B:[[1,1,1,1,0],[1,0,0,0,1],[1,1,1,1,0],[1,0,0,0,1],[1,1,1,1,0]],C:[[0,1,1,1,0],[1,0,0,0,1],[1,0,0,0,0],[1,0,0,0,1],[0,1,1,1,0]],D:[[1,1,1,1,0],[1,0,0,0,1],[1,0,0,0,1],[1,0,0,0,1],[1,1,1,1,0]],E:[[1,1,1,1,1],[1,0,0,0,0],[1,1,1,0,0],[1,0,0,0,0],[1,1,1,1,1]],F:[[1,1,1,1,1],[1,0,0,0,0],[1,1,1,0,0],[1,0,0,0,0],[1,0,0,0,0]],G:[[0,1,1,1,1],[1,0,0,0,0],[1,0,1,1,1],[1,0,0,0,1],[0,1,1,1,1]],H:[[1,0,0,0,1],[1,0,0,0,1],[1,1,1,1,1],[1,0,0,0,1],[1,0,0,0,1]],I:[[1,1,1,1,1],[0,0,1,0,0],[0,0,1,0,0],[0,0,1,0,0],[1,1,1,1,1]],J:[[1,1,1,1,1],[0,0,1,0,0],[0,0,1,0,0],[1,0,1,0,0],[0,1,1,0,0]],K:[[1,0,0,0,1],[1,0,0,1,0],[1,1,1,0,0],[1,0,0,1,0],[1,0,0,0,1]],L:[[1,0,0,0,0],[1,0,0,0,0],[1,0,0,0,0],[1,0,0,0,0],[1,1,1,1,1]],M:[[1,0,0,0,1],[1,1,0,1,1],[1,0,1,0,1],[1,0,0,0,1],[1,0,0,0,1]],N:[[1,0,0,0,1],[1,1,0,0,1],[1,0,1,0,1],[1,0,0,1,1],[1,0,0,0,1]],O:[[0,1,1,1,0],[1,0,0,0,1],[1,0,0,0,1],[1,0,0,0,1],[0,1,1,1,0]],P:[[1,1,1,1,0],[1,0,0,0,1],[1,0,0,0,1],[1,1,1,1,0],[1,0,0,0,0]],Q:[[0,1,1,1,0],[1,0,0,0,1],[1,0,0,0,1],[1,0,0,1,1],[0,1,1,1,1]],R:[[1,1,1,1,0],[1,0,0,0,1],[1,0,0,0,1],[1,1,1,1,0],[1,0,0,0,1]],S:[[0,1,1,1,1],[1,0,0,0,0],[1,1,1,1,1],[0,0,0,0,1],[1,1,1,1,0]],T:[[1,1,1,1,1],[0,0,1,0,0],[0,0,1,0,0],[0,0,1,0,0],[0,0,1,0,0]],U:[[1,0,0,0,1],[1,0,0,0,1],[1,0,0,0,1],[1,0,0,0,1],[0,1,1,1,0]],V:[[1,0,0,0,1],[1,0,0,0,1],[0,1,0,1,0],[0,1,0,1,0],[0,0,1,0,0]],W:[[1,0,0,0,1],[1,0,0,0,1],[1,0,1,0,1],[1,0,1,0,1],[0,1,0,1,0]],X:[[1,0,0,0,1],[0,1,0,1,0],[0,0,1,0,0],[0,1,0,1,0],[1,0,0,0,1]],Y:[[1,0,0,0,1],[0,1,0,1,0],[0,0,1,0,0],[0,0,1,0,0],[0,0,1,0,0]],Z:[[1,1,1,1,1],[0,0,0,1,0],[0,0,1,0,0],[0,1,0,0,0],[1,1,1,1,1]]},i.Symbols={arrow:[[0,0,0,1,0,0],[0,0,0,1,1,0],[1,1,1,1,1,1],[1,1,1,1,1,1],[0,0,0,1,1,0],[0,0,0,1,0,0]],square:[[1,1,1,1,1,1],[1,1,1,1,1,1],[1,1,0,0,1,1],[1,1,0,0,1,1],[1,1,1,1,1,1],[1,1,1,1,1,1]],triangle:[[0,0,0,1,0,0,0],[0,0,1,1,1,0,0],[0,1,1,1,1,1,0],[1,1,1,1,1,1,1]],diamond:[[0,0,0,1,0,0,0],[0,0,1,1,1,0,0],[0,1,1,1,1,1,0],[1,1,1,1,1,1,1],[0,1,1,1,1,1,0],[0,0,1,1,1,0,0],[0,0,0,1,0,0,0]],zigzagw:[[1,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,1],[0,1,0,0,0,0,0,1,0,1,0,0,0,0,0,1,0],[0,0,1,0,0,0,1,0,0,0,1,0,0,0,1,0,0],[0,0,0,1,0,1,0,0,0,0,0,1,0,1,0,0,0],[0,0,0,0,1,0,0,0,0,0,0,0,1,0,0,0,0]],zigzagm:[[0,0,0,0,1,0,0,0,0,0,0,0,1,0,0,0,0],[0,0,0,1,0,1,0,0,0,0,0,1,0,1,0,0,0],[0,0,1,0,0,0,1,0,0,0,1,0,0,0,1,0,0],[0,1,0,0,0,0,0,1,0,1,0,0,0,0,0,1,0],[1,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,1]]},cc._RF.pop()},{}],EventMgr:[function(t,e,i){"use strict";cc._RF.push(e,"f8ad5rydN9EIZ62nOSFY4Dg","EventMgr");var o=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function o(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(o.prototype=i.prototype,new o)}}();Object.defineProperty(i,"__esModule",{value:!0}),i.EventMgr=void 0;var n=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return o(e,t),e.instance=null,e}(cc.EventTarget);i.EventMgr=n,n.instance=new n,cc._RF.pop()},{}],Evil:[function(t,e,i){"use strict";cc._RF.push(e,"fbb52MKdNBJgpfpJ8Q5p3TY","Evil");var o=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function o(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(o.prototype=i.prototype,new o)}}(),n=this&&this.__decorate||function(t,e,i,o){var n,r=arguments.length,c=r<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,i):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)c=Reflect.decorate(t,e,i,o);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(c=(r<3?n(c):r>3?n(e,i,c):n(e,i))||c);return r>3&&c&&Object.defineProperty(e,i,c),c};Object.defineProperty(i,"__esModule",{value:!0});var r,c=t("./Defines"),s=t("./core/Timer"),a=cc._decorator,u=a.ccclass;a.property;(function(t){t[t.IDLE=0]="IDLE",t[t.FLY=1]="FLY",t[t.FLY_OUT=2]="FLY_OUT",t[t.WAITING=3]="WAITING"})(r||(r={}));var p=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.timerWaiting=new s.default,e.angle=0,e.dir=1,e}return o(e,t),e.prototype.start=function(){this.SetState(r.IDLE)},e.prototype.update=function(t){switch(this.state){case r.IDLE:break;case r.WAITING:this.timerWaiting.Update(t),this.timerWaiting.IsDone()&&this.SetState(r.IDLE);break;case r.FLY:this.dir>0?this.angle>1440&&this.SetState(r.FLY_OUT):this.angle<-1260&&this.SetState(r.FLY_OUT),this.center=this.center.lerp(this.target.position,t),this.center.x+=c.default.GAME_SPEED_MIN*c.default.GAME_BASE_SPEED*t,this.UpdateFly(t);break;case r.FLY_OUT:this.center=this.center.lerp(cc.v3(this.target.position.x-cc.winSize.width/2,this.target.position.y,0),t/5),this.center.x+=c.default.GAME_SPEED_MIN/2*c.default.GAME_BASE_SPEED*t,this.UpdateFly(t),this.IsOutOfScreen()&&this.Waiting(1)}},e.prototype.SetState=function(t){switch(this.state=t,this.state){case r.IDLE:case r.FLY:}},e.prototype.Waiting=function(t){this.timerWaiting.SetDuration(t),this.SetState(r.WAITING)},e.prototype.Fly=function(t,e,i){this.target=t,this.center=i,this.dir=e,this.angle=e>0?0:180,this.SetState(r.FLY)},e.prototype.FlyOut=function(){this.state==r.FLY&&this.SetState(r.FLY_OUT)},e.prototype.Dead=function(){this.SetState(r.IDLE)},e.prototype.IsOutOfScreen=function(){var t=cc.Camera.main.node.position;return this.node.position.x-t.x<0},e.prototype.UpdateFly=function(t){this.angle+=this.dir*c.default.GAME_BASE_SPEED*t;var e=350*Math.cos(this.angle*Math.PI/180),i=200*Math.sin(this.angle*Math.PI/180);this.node.setPosition(cc.v3(this.center.x+e,this.center.y+i,0))},e=n([u],e)}(cc.Component);i.default=p,cc._RF.pop()},{"./Defines":"Defines","./core/Timer":"Timer"}],GameMgr:[function(t,e,i){"use strict";cc._RF.push(e,"15fb3AUZERDaaRXtnJ70/ub","GameMgr");var o=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function o(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(o.prototype=i.prototype,new o)}}(),n=this&&this.__decorate||function(t,e,i,o){var n,r=arguments.length,c=r<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,i):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)c=Reflect.decorate(t,e,i,o);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(c=(r<3?n(c):r>3?n(e,i,c):n(e,i))||c);return r>3&&c&&Object.defineProperty(e,i,c),c},r=this&&this.__awaiter||function(t,e,i,o){function n(t){return t instanceof i?t:new i(function(e){e(t)})}return new(i||(i=Promise))(function(i,r){function c(t){try{a(o.next(t))}catch(t){r(t)}}function s(t){try{a(o.throw(t))}catch(t){r(t)}}function a(t){t.done?i(t.value):n(t.value).then(c,s)}a((o=o.apply(t,e||[])).next())})},c=this&&this.__generator||function(t,e){var i,o,n,r,c={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return r={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function s(t){return function(e){return a([t,e])}}function a(r){if(i)throw new TypeError("Generator is already executing.");for(;c;)try{if(i=1,o&&(n=2&r[0]?o.return:r[0]?o.throw||((n=o.return)&&n.call(o),0):o.next)&&!(n=n.call(o,r[1])).done)return n;switch(o=0,n&&(r=[2&r[0],n.value]),r[0]){case 0:case 1:n=r;break;case 4:return c.label++,{value:r[1],done:!1};case 5:c.label++,o=r[1],r=[0];continue;case 7:r=c.ops.pop(),c.trys.pop();continue;default:if(!(n=(n=c.trys).length>0&&n[n.length-1])&&(6===r[0]||2===r[0])){c=0;continue}if(3===r[0]&&(!n||r[1]>n[0]&&r[1]<n[3])){c.label=r[1];break}if(6===r[0]&&c.label<n[1]){c.label=n[1],n=r;break}if(n&&c.label<n[2]){c.label=n[2],c.ops.push(r);break}n[2]&&c.ops.pop(),c.trys.pop();continue}r=e.call(t,c)}catch(t){r=[6,t],o=0}finally{i=n=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}};Object.defineProperty(i,"__esModule",{value:!0});var s,a=t("./core/EventMgr"),u=t("./Defines"),p=t("./Player"),l=t("./core/Input"),h=t("./ui/MainMenu"),f=t("./ui/Ingame"),d=t("./ui/Score"),y=t("./Settings"),v=t("./ui/Loading"),_=t("./core/Timer"),S=t("./camera/VideoCamera"),g=t("./ml5/ML5Wrapper"),m=t("./CollectibleMgr"),w=t("./SimpleFaceDetect"),E=t("./ObstacleMgr"),b=t("./API"),I=t("./Message"),P=cc._decorator,O=P.ccclass,T=P.property;(function(t){t[t.INIT=0]="INIT",t[t.TOUCH_TO_PLAY=1]="TOUCH_TO_PLAY",t[t.COUNTDOWN=2]="COUNTDOWN",t[t.PLAYING=3]="PLAYING",t[t.PAUSE=4]="PAUSE",t[t.RESUME=5]="RESUME",t[t.WIN_DELAY=6]="WIN_DELAY",t[t.WIN=7]="WIN",t[t.LOSE_DELAY=8]="LOSE_DELAY",t[t.LOSE=9]="LOSE"})(s||(s={}));var M=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.obstacleMgr=null,e.collectibleMgr=null,e.viewMainMenu=null,e.viewIngame=null,e.viewLoading=null,e.viewScore=null,e.viewMessage=null,e.player=null,e.audioBgm=null,e.audioWin=null,e.audioLose=null,e.audioClick=null,e.videoCamera=new S.default,e.timerMain=new _.default,e.timerDelay=new _.default,e.timerCountdown=new _.default,e.audioBgmId=0,e.detectPoint=cc.v2(cc.winSize.width/2,cc.winSize.height/2),e.speed=u.default.GAME_SPEED_MIN,e.speedTarget=u.default.GAME_SPEED_MIN,e.score=0,e.countdown=3,e}return o(e,t),e.prototype.onLoad=function(){cc.director.getPhysicsManager().enabled=!0,cc.director.getCollisionManager().enabled=!0,window.innerWidth<window.innerHeight?cc.Canvas.instance.designResolution=new cc.Size(750,1334):cc.Canvas.instance.designResolution=new cc.Size(1334,750),this.timerDelay.SetDuration(3),this.timerCountdown.SetDuration(1)},e.prototype.start=function(){a.EventMgr.instance.on(u.GameEvent.TOUCH,this.TouchHandler,this),a.EventMgr.instance.on(u.GameEvent.COLLECT_ITEM,this.OnScore,this),a.EventMgr.instance.on(u.GameEvent.PLAYER_HURT,this.OnHurt,this),this.pusher=new window.Pusher("9ffb9507bc94e5760d4f",{cluster:"ap1"});var t=window.userParams.ch;this.channel=t?this.pusher.subscribe("utop-"+t):this.pusher.subscribe("utop");try{var e=JSON.parse(cc.sys.localStorage.getItem("settings"));null!=e&&(y.default.useSound!=e.useSound&&(console.log(JSON.stringify(e)),this.viewMainMenu.SwitchSound()),y.default.useSound&&this.PlayBgm())}catch(t){}this.SetupCameraML5(),this.SetState(s.INIT)},e.prototype.update=function(t){switch(this.state){case s.INIT:break;case s.TOUCH_TO_PLAY:this.UpdateSpeed(t);break;case s.COUNTDOWN:this.timerCountdown.Update(t),this.timerCountdown.JustFinished()&&(this.countdown--,this.countdown>0?(this.viewIngame.SetCountdown(this.countdown),this.timerCountdown.Reset()):0==this.countdown?(this.viewIngame.SetCountdown("GO"),this.timerCountdown.Reset()):(this.viewIngame.SetCountdown(""),this.SetState(s.PLAYING)));break;case s.PLAYING:this.UpdateSpeed(t),this.timerMain.Update(t),this.timerMain.JustFinished()&&this.SetState(s.WIN_DELAY),this.viewIngame.SetTime(Math.floor(this.timerMain.GetTime()));break;case s.WIN_DELAY:this.UpdateSpeed(t),this.timerDelay.Update(t),this.timerDelay.JustFinished()&&this.SetState(s.WIN);break;case s.WIN:this.UpdateSpeed(t);break;case s.LOSE_DELAY:this.timerDelay.Update(t),this.timerDelay.JustFinished()&&this.SetState(s.LOSE)}null!=this.videoDom&&this.videoCamera.Render(this.videoDom)},e.prototype.SetState=function(t){var e=this;switch(this.state=t,t){case s.INIT:cc.Camera.main.node.setPosition(0,cc.Camera.main.node.position.y),y.default.useSound&&this.PlayBgm(),this.speed=u.default.GAME_SPEED_MIN,this.speedTarget=u.default.GAME_SPEED_MIN,this.score=0,this.timerMain.SetDuration(u.default.GAME_TIMEOUT),this.obstacleMgr.Init(),this.collectibleMgr.Init(),this.player.Init(),this.PusherInit(),this.viewMainMenu.Show(function(){e.SetState(s.TOUCH_TO_PLAY)}),this.viewIngame.Hide(),this.viewIngame.ResetScore(),this.viewIngame.SetTime(Math.floor(this.timerMain.GetTime()));break;case s.TOUCH_TO_PLAY:this.player.TouchToPlay(),this.collectibleMgr.Play();break;case s.COUNTDOWN:this.countdown=3,this.player.Play(),this.player.DisableMagnet(),this.collectibleMgr.Reset(),this.viewMainMenu.Hide(),this.viewIngame.Show(),this.viewIngame.SetCountdown(this.countdown),this.timerCountdown.Reset();break;case s.PLAYING:this.obstacleMgr.Play();break;case s.WIN_DELAY:this.timerDelay.Reset(),this.obstacleMgr.Dead(),this.collectibleMgr.Dead(),this.player.Win();break;case s.WIN:this.StopBgm(),this.audioWin.play(),this.GameFinish();break;case s.LOSE_DELAY:this.StopBgm(),this.audioLose.play(),this.timerDelay.Reset(),this.obstacleMgr.Dead(),this.collectibleMgr.Dead(),this.player.Lose();break;case s.LOSE:this.GameFinish();break;case s.PAUSE:this.StopBgm(),this.player.Pause();break;case s.RESUME:this.PlayBgm(),this.player.Resume(),this.state=s.PLAYING}},e.prototype.UpdateSpeed=function(t){var e=cc.Camera.main.node.position;cc.Camera.main.node.setPosition(e.x+this.speed*u.default.GAME_BASE_SPEED*t,e.y),this.speed=cc.misc.lerp(this.speed,this.speedTarget,.1)},e.prototype.Replay=function(){},e.prototype.ScoreRetry=function(){y.default.useSound&&this.audioClick.play(),this.Replay()},e.prototype.ScoreHome=function(){window.parent.location.href=window.userParams.homeUrl},e.prototype.ScoreStore=function(){window.location.href=window.userParams.storeUrl},e.prototype.ErrorClose=function(){},e.prototype.SwitchSound=function(){this.viewMainMenu.SwitchSound(),y.default.useSound?this.PlayBgm():this.StopBgm(),cc.sys.localStorage.setItem("settings",JSON.stringify(y.default))},e.prototype.OnScore=function(t){var e=t.node.scale==u.default.COLLECTIBLE_SCALE?10:1;t.type==u.CollectibleType.MENU?(10==e&&this.player.EnableMagnet(),this.state==s.PLAYING&&(this.score+=e)):this.state==s.PLAYING&&(this.score+=e),this.viewIngame.SetScore(this.score)},e.prototype.OnHurt=function(t){this.SetState(s.LOSE_DELAY)},e.prototype.GameResume=function(){cc.game.resume()},e.prototype.GamePause=function(){this.state==s.PLAYING&&this.SetState(s.PAUSE),cc.game.pause()},e.prototype.GameFinish=function(){var t=this,e=window.userParams;b.default.EndGame(e.IDTrans,e.sessionID,this.score).then(function(e){try{var i=JSON.parse(e);0==i.code?0==i.typeKQ?t.GameLose("B\u1ea1n kh\xf4ng \u0111\u1ee7 \u0111i\u1ec3m \u0111\u1ec3 tr\xfang th\u01b0\u1edfng"):1==i.typeKQ?t.GameLose("S\u1ed1 l\u01b0\u1ee3ng qu\xe0 \u0111\xe3 v\u01b0\u1ee3t qu\xe1 gi\u1edbi h\u1ea1n"):3==i.typeKQ&&(0==i.gameRewardType?t.GameLose("S\u1ed1 l\u01b0\u1ee3ng qu\xe0 \u0111\xe3 v\u01b0\u1ee3t qu\xe1 gi\u1edbi h\u1ea1n"):(t.obstacleMgr.evil.FlyOut(),t.GameWin(i.rewardName))):(t.viewLoading.node.active=!1,t.ShowMessage(i.loi,function(){t.SetState(s.INIT)}))}catch(e){t.viewLoading.node.active=!1,t.ShowMessage("D\u1eef li\u1ec7u kh\xf4ng \u0111\xfang c\u1ea5u tr\xfac.",function(){t.SetState(s.INIT)})}}).catch(function(e){t.ShowMessage("Kh\xf4ng th\u1ec3 k\u1ebft n\u1ed1i v\u1edbi m\xe1y ch\u1ee7. Vui l\xf2ng ki\u1ec3m tra k\u1ebft n\u1ed1i m\u1ea1ng v\xe0 th\u1eed l\u1ea1i.",function(){t.SetState(s.INIT)})})},e.prototype.ShowMessage=function(t,e){void 0===e&&(e=null),this.viewMessage.SetDescription(t,e),this.viewMessage.node.active=!0},e.prototype.GameWin=function(t){var e=this;this.viewScore.SetWin(this.score,t,function(){e.SetState(s.INIT)}),this.viewScore.node.active=!0,this.viewIngame.node.active=!1},e.prototype.GameLose=function(t){var e=this;this.viewScore.SetLose(t,function(){e.SetState(s.INIT)}),this.viewScore.node.active=!0,this.viewIngame.node.active=!1},e.prototype.PlayBgm=function(){this.audioBgmId=cc.audioEngine.play(this.audioBgm.clip,!0,1)},e.prototype.StopBgm=function(){cc.audioEngine.stop(this.audioBgmId)},e.prototype.PusherInit=function(){var t=this;this.channel.bind("start-game",function(e){var i=window.userParams;i.sessionID=e.message.sessionID,t.viewLoading.node.active=!0,b.default.StartGame(i.gc,i.ch,i.sessionID).then(function(e){try{var o=JSON.parse(e);0==o.code?(i.IDTrans=o.idTrans,t.viewLoading.node.active=!1,t.channel.unbind("start-game"),t.SetState(s.COUNTDOWN)):(t.viewLoading.node.active=!1,t.ShowMessage(o.result))}catch(e){t.viewLoading.node.active=!1,t.ShowMessage("D\u1eef li\u1ec7u kh\xf4ng \u0111\xfang c\u1ea5u tr\xfac.")}}).catch(function(e){t.viewLoading.node.active=!1,t.ShowMessage(e)})})},e.prototype.TouchHandler=function(t){switch(this.state){case s.INIT:break;case s.TOUCH_TO_PLAY:l.default.instance.IsTouchDown(t)&&this.SetState(s.COUNTDOWN);break;case s.PLAYING:break;case s.PAUSE:this.SetState(s.RESUME)}},e.prototype.SetupCameraML5=function(){return r(this,void 0,void 0,function(){var t,e,i,o,n=this;return c(this,function(r){switch(r.label){case 0:return t=this,[4,this.videoCamera.Init(u.default.USE_SIMPLE_FACE_DETECT)];case 1:return t.videoDom=r.sent(),u.default.USE_SIMPLE_FACE_DETECT?[3,3]:(e=new g.default,i=this,[4,e.Init(this.videoDom)]);case 2:return i.ml5PoseNet=r.sent(),this.ml5PoseNet.on("pose",this.OnML5PoseNet.bind(this)),[3,4];case 3:o=w.default.Init(),setInterval(function(){o(n.videoDom,n.OnSimpleFaceDectect.bind(n))},50),r.label=4;case 4:return[2]}})})},e.prototype.OnML5PoseNet=function(t){var e=this;if(!l.default.instance.isHold&&t.length>0){var i=t.map(function(t){var i=cc.v2(t.pose.nose.x,t.pose.nose.y);return{nose:i,distance:cc.Vec2.distance(i,e.detectPoint)}}).sort(function(t,e){return t.distance-e.distance})[0].nose,o=(this.videoDom.videoHeight-this.videoCamera.canvas.height)/2,n=i.x*cc.winSize.width/this.videoCamera.canvas.width,r=(i.y-o)*cc.winSize.height/this.videoCamera.canvas.height;this.player.SetTarget(cc.v3(cc.winSize.width-n,cc.winSize.height-r,0)),this.detectPoint=i,this.timerFaceDetect.Reset()}},e.prototype.OnSimpleFaceDectect=function(t){l.default.instance.isHold||this.player.SetTarget(cc.v3(cc.winSize.width-t.x,cc.winSize.height-t.y,0))},n([T({type:E.default})],e.prototype,"obstacleMgr",void 0),n([T({type:m.default})],e.prototype,"collectibleMgr",void 0),n([T({type:h.default})],e.prototype,"viewMainMenu",void 0),n([T({type:f.default})],e.prototype,"viewIngame",void 0),n([T({type:v.default})],e.prototype,"viewLoading",void 0),n([T({type:d.default})],e.prototype,"viewScore",void 0),n([T({type:I.default})],e.prototype,"viewMessage",void 0),n([T({type:p.default})],e.prototype,"player",void 0),n([T({type:cc.AudioSource})],e.prototype,"audioBgm",void 0),n([T({type:cc.AudioSource})],e.prototype,"audioWin",void 0),n([T({type:cc.AudioSource})],e.prototype,"audioLose",void 0),n([T({type:cc.AudioSource})],e.prototype,"audioClick",void 0),e=n([O],e)}(cc.Component);i.default=M,cc._RF.pop()},{"./API":"API","./CollectibleMgr":"CollectibleMgr","./Defines":"Defines","./Message":"Message","./ObstacleMgr":"ObstacleMgr","./Player":"Player","./Settings":"Settings","./SimpleFaceDetect":"SimpleFaceDetect","./camera/VideoCamera":"VideoCamera","./core/EventMgr":"EventMgr","./core/Input":"Input","./core/Timer":"Timer","./ml5/ML5Wrapper":"ML5Wrapper","./ui/Ingame":"Ingame","./ui/Loading":"Loading","./ui/MainMenu":"MainMenu","./ui/Score":"Score"}],Ingame:[function(t,e,i){"use strict";cc._RF.push(e,"ce56bZ/jydEaJ9euUC2iteW","Ingame");var o=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function o(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(o.prototype=i.prototype,new o)}}(),n=this&&this.__decorate||function(t,e,i,o){var n,r=arguments.length,c=r<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,i):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)c=Reflect.decorate(t,e,i,o);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(c=(r<3?n(c):r>3?n(e,i,c):n(e,i))||c);return r>3&&c&&Object.defineProperty(e,i,c),c};Object.defineProperty(i,"__esModule",{value:!0});var r=t("../Defines"),c=cc._decorator,s=c.ccclass,a=c.property,u=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.score=null,e.time=null,e.timeFill=null,e.countdown=null,e.countdownLabel=null,e.scoreCurrent=0,e.scoreTarget=0,e}return o(e,t),e.prototype.update=function(t){this.scoreCurrent<this.scoreTarget?this.scoreCurrent++:this.scoreCurrent>this.scoreTarget&&(this.scoreCurrent-=5),this.scoreCurrent<0&&(this.scoreCurrent=0),this.score.string=""+this.scoreCurrent},e.prototype.SetScore=function(t){this.scoreTarget=t},e.prototype.ResetScore=function(){this.scoreCurrent=0,this.scoreTarget=0,this.score.string=""+this.scoreCurrent},e.prototype.SetTime=function(t){var e=t/r.default.GAME_TIMEOUT;this.time.string=""+t,this.timeFill.fillRange=e},e.prototype.SetCountdown=function(t){this.countdownLabel.string=""+t,this.countdown.scale=0,cc.tween(this.countdown).to(.5,{scale:1},{easing:"elasticOut"}).start()},e.prototype.Show=function(){this.node.active=!0},e.prototype.Hide=function(){this.node.active=!1},n([a(cc.Label)],e.prototype,"score",void 0),n([a(cc.Label)],e.prototype,"time",void 0),n([a(cc.Sprite)],e.prototype,"timeFill",void 0),n([a(cc.Node)],e.prototype,"countdown",void 0),n([a(cc.Label)],e.prototype,"countdownLabel",void 0),e=n([s],e)}(cc.Component);i.default=u,cc._RF.pop()},{"../Defines":"Defines"}],Init:[function(t,e,i){"use strict";cc._RF.push(e,"fb0e64rMu1It448CA4JE5/E","Init");var o=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function o(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(o.prototype=i.prototype,new o)}}(),n=this&&this.__decorate||function(t,e,i,o){var n,r=arguments.length,c=r<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,i):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)c=Reflect.decorate(t,e,i,o);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(c=(r<3?n(c):r>3?n(e,i,c):n(e,i))||c);return r>3&&c&&Object.defineProperty(e,i,c),c};Object.defineProperty(i,"__esModule",{value:!0});var r=t("./Defines"),c=cc._decorator,s=c.ccclass,a=c.property,u=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.loadingIcon=null,e.loadingError=null,e.progress=null,e}return o(e,t),e.prototype.start=function(){this.LoadScene()},e.prototype.update=function(t){this.loadingIcon.angle-=2*r.default.GAME_BASE_SPEED*t},e.prototype.LoadScene=function(){var t=this;this.loadingIcon.active=!0,this.progress.node.active=!0,this.loadingError.active=!1,cc.director.preloadScene("main",function(e,i,o){var n=e/i;t.progress.string=Math.floor(100*n)+"%"},function(e){if(e)return t.loadingIcon.active=!1,t.progress.node.active=!1,void(t.loadingError.active=!0);cc.director.loadScene("main")})},n([a({type:cc.Node})],e.prototype,"loadingIcon",void 0),n([a({type:cc.Node})],e.prototype,"loadingError",void 0),n([a({type:cc.Label})],e.prototype,"progress",void 0),e=n([s],e)}(cc.Component);i.default=u,cc._RF.pop()},{"./Defines":"Defines"}],Input:[function(t,e,i){"use strict";cc._RF.push(e,"86a1eETgqhC7LCRoYW35gpp","Input");var o=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function o(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(o.prototype=i.prototype,new o)}}(),n=this&&this.__decorate||function(t,e,i,o){var n,r=arguments.length,c=r<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,i):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)c=Reflect.decorate(t,e,i,o);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(c=(r<3?n(c):r>3?n(e,i,c):n(e,i))||c);return r>3&&c&&Object.defineProperty(e,i,c),c};Object.defineProperty(i,"__esModule",{value:!0});var r=t("./EventMgr"),c=t("../Defines"),s=cc._decorator,a=s.ccclass,u=(s.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.position=new cc.Vec2(0,0),e.prevPosition=new cc.Vec2(0,0),e.delta=new cc.Vec2(0,0),e.isHold=!1,e}var i;return o(e,t),i=e,e.prototype.onLoad=function(){i.instance=this,this.node.on(cc.Node.EventType.TOUCH_START,this.onTouchStart,this),this.node.on(cc.Node.EventType.TOUCH_END,this.onTouchEnd,this),this.node.on(cc.Node.EventType.TOUCH_MOVE,this.onTouchMove,this)},e.prototype.start=function(){},e.prototype.update=function(t){this.isHold&&(cc.Vec2.subtract(this.delta,this.position,this.prevPosition),this.prevPosition=this.position)},e.prototype.onTouchStart=function(t){this.position=t.touch.getLocation(),this.prevPosition=t.touch.getLocation(),this.isHold=!0,r.EventMgr.instance.emit(c.GameEvent.TOUCH,t)},e.prototype.onTouchEnd=function(t){this.delta=new cc.Vec2(0,0),this.isHold=!1,r.EventMgr.instance.emit(c.GameEvent.TOUCH,t)},e.prototype.onTouchMove=function(t){this.position=t.touch.getLocation(),r.EventMgr.instance.emit(c.GameEvent.TOUCH,t)},e.prototype.IsTouchDown=function(t){return t.type==cc.Node.EventType.TOUCH_START},e.instance=null,e=i=n([a],e)}(cc.Component));i.default=u,cc._RF.pop()},{"../Defines":"Defines","./EventMgr":"EventMgr"}],Loading:[function(t,e,i){"use strict";cc._RF.push(e,"2d4afTuZMtEMrP5rpbFpmae","Loading");var o=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function o(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(o.prototype=i.prototype,new o)}}(),n=this&&this.__decorate||function(t,e,i,o){var n,r=arguments.length,c=r<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,i):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)c=Reflect.decorate(t,e,i,o);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(c=(r<3?n(c):r>3?n(e,i,c):n(e,i))||c);return r>3&&c&&Object.defineProperty(e,i,c),c};Object.defineProperty(i,"__esModule",{value:!0});var r=t("../Defines"),c=cc._decorator,s=c.ccclass,a=c.property,u=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.icon=null,e}return o(e,t),e.prototype.update=function(t){this.icon.angle-=2*r.default.GAME_BASE_SPEED*t},n([a(cc.Node)],e.prototype,"icon",void 0),e=n([s],e)}(cc.Component);i.default=u,cc._RF.pop()},{"../Defines":"Defines"}],ML5Wrapper:[function(t,e,i){"use strict";cc._RF.push(e,"20114E7oaRPHrR5hNQHODla","ML5Wrapper");var o=this&&this.__awaiter||function(t,e,i,o){function n(t){return t instanceof i?t:new i(function(e){e(t)})}return new(i||(i=Promise))(function(i,r){function c(t){try{a(o.next(t))}catch(t){r(t)}}function s(t){try{a(o.throw(t))}catch(t){r(t)}}function a(t){t.done?i(t.value):n(t.value).then(c,s)}a((o=o.apply(t,e||[])).next())})},n=this&&this.__generator||function(t,e){var i,o,n,r,c={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return r={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function s(t){return function(e){return a([t,e])}}function a(r){if(i)throw new TypeError("Generator is already executing.");for(;c;)try{if(i=1,o&&(n=2&r[0]?o.return:r[0]?o.throw||((n=o.return)&&n.call(o),0):o.next)&&!(n=n.call(o,r[1])).done)return n;switch(o=0,n&&(r=[2&r[0],n.value]),r[0]){case 0:case 1:n=r;break;case 4:return c.label++,{value:r[1],done:!1};case 5:c.label++,o=r[1],r=[0];continue;case 7:r=c.ops.pop(),c.trys.pop();continue;default:if(!(n=(n=c.trys).length>0&&n[n.length-1])&&(6===r[0]||2===r[0])){c=0;continue}if(3===r[0]&&(!n||r[1]>n[0]&&r[1]<n[3])){c.label=r[1];break}if(6===r[0]&&c.label<n[1]){c.label=n[1],n=r;break}if(n&&c.label<n[2]){c.label=n[2],c.ops.push(r);break}n[2]&&c.ops.pop(),c.trys.pop();continue}r=e.call(t,c)}catch(t){r=[6,t],o=0}finally{i=n=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}};Object.defineProperty(i,"__esModule",{value:!0});var r=function(){function t(){}return t.prototype.Init=function(t){return o(this,void 0,void 0,function(){var e;return n(this,function(i){switch(i.label){case 0:return e={architecture:"MobileNetV1",imageScaleFactor:.1,outputStride:16,minConfidence:.05,maxPoseDetections:5,scoreThreshold:.5,nmsRadius:20,detectionType:"multiple",inputResolution:161,multiplier:.75,quantBytes:2},[4,window.ml5.poseNet(t,e)];case 1:return[2,i.sent()]}})})},t}();i.default=r,cc._RF.pop()},{}],MainMenu:[function(t,e,i){"use strict";cc._RF.push(e,"351efv7WZBKH6uOJ8Wks8g4","MainMenu");var o=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function o(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(o.prototype=i.prototype,new o)}}(),n=this&&this.__decorate||function(t,e,i,o){var n,r=arguments.length,c=r<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,i):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)c=Reflect.decorate(t,e,i,o);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(c=(r<3?n(c):r>3?n(e,i,c):n(e,i))||c);return r>3&&c&&Object.defineProperty(e,i,c),c};Object.defineProperty(i,"__esModule",{value:!0});var r=t("../Settings"),c=cc._decorator,s=c.ccclass,a=c.property,u=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.slogun=null,e}return o(e,t),e.prototype.start=function(){},e.prototype.update=function(t){},e.prototype.Show=function(t){this.slogun.active=!0,t()},e.prototype.Hide=function(){this.slogun.active=!1},e.prototype.SwitchSound=function(){r.default.useSound=!r.default.useSound},n([a(cc.Node)],e.prototype,"slogun",void 0),e=n([s],e)}(cc.Component);i.default=u,cc._RF.pop()},{"../Settings":"Settings"}],Message:[function(t,e,i){"use strict";cc._RF.push(e,"128b61G1odLzKumkTFkT8WU","Message");var o=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function o(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(o.prototype=i.prototype,new o)}}(),n=this&&this.__decorate||function(t,e,i,o){var n,r=arguments.length,c=r<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,i):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)c=Reflect.decorate(t,e,i,o);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(c=(r<3?n(c):r>3?n(e,i,c):n(e,i))||c);return r>3&&c&&Object.defineProperty(e,i,c),c};Object.defineProperty(i,"__esModule",{value:!0});var r=t("./Defines"),c=t("./core/Timer"),s=cc._decorator,a=s.ccclass,u=s.property,p=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.description=null,e.timerHide=null,e}return o(e,t),e.prototype.onEnable=function(){this.node.setScale(.01),cc.tween(this.node).to(.5,{scale:1},{easing:"elasticOut"}).start()},e.prototype.start=function(){},e.prototype.update=function(t){null!=this.timerHide&&(this.timerHide.Update(t),this.timerHide.JustFinished()&&this.OnClose())},e.prototype.SetDescription=function(t,e){void 0===e&&(e=null),this.description.string=t,this.callback=e,this.timerHide=new c.default,this.timerHide.SetDuration(r.default.GAME_RESULT_TIMEOUT)},e.prototype.OnClose=function(){var t=this;cc.tween(this.node).to(.5,{scale:0},{easing:"elasticIn"}).call(function(){t.node.active=!1,null!=t.callback&&t.callback()}).start()},n([u({type:cc.Label})],e.prototype,"description",void 0),e=n([a],e)}(cc.Component);i.default=p,cc._RF.pop()},{"./Defines":"Defines","./core/Timer":"Timer"}],ObstacleMgr:[function(t,e,i){"use strict";cc._RF.push(e,"76c39EBKUlEkqbPqSITHDnu","ObstacleMgr");var o=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function o(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(o.prototype=i.prototype,new o)}}(),n=this&&this.__decorate||function(t,e,i,o){var n,r=arguments.length,c=r<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,i):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)c=Reflect.decorate(t,e,i,o);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(c=(r<3?n(c):r>3?n(e,i,c):n(e,i))||c);return r>3&&c&&Object.defineProperty(e,i,c),c};Object.defineProperty(i,"__esModule",{value:!0});var r,c=t("./Defines"),s=t("./Rocket"),a=t("./Evil"),u=t("./core/Timer"),p=cc._decorator,l=p.ccclass,h=p.property;(function(t){t[t.INIT=0]="INIT",t[t.PLAYING=1]="PLAYING",t[t.DEAD=2]="DEAD"})(r||(r={}));var f=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.rocketPrefab=null,e.evil=null,e.player=null,e.rockets=[],e.timerSpawnEvil=new u.default,e.timerSpawnRocket=new u.default,e}return o(e,t),e.prototype.start=function(){},e.prototype.update=function(t){if(!cc.game.isPaused())switch(this.state){case r.INIT:break;case r.PLAYING:this.timerSpawnEvil.Update(t),this.timerSpawnEvil.JustFinished()&&this.SpawnEvil(),this.timerSpawnRocket.Update(t),this.timerSpawnRocket.JustFinished()&&(this.SpawnRocket(this.player.position.y,this.rocketSpeed),this.timerSpawnRocket.SetDuration(c.RandomInt(4,6)));break;case r.DEAD:}},e.prototype.SetState=function(t){switch(this.state=t,t){case r.INIT:this.rocketSpeed=10,this.timerSpawnEvil.SetDuration(c.default.GAME_TIMEOUT/2),this.timerSpawnRocket.SetDuration(c.default.GAME_TIMEOUT/6),this.rockets=[];for(var e=0;e<c.default.ROCKET_MAX;e++){var i=cc.instantiate(this.rocketPrefab);i.parent=this.node,i.active=!1,this.rockets.push(i)}break;case r.PLAYING:break;case r.DEAD:this.evil.Dead()}},e.prototype.Init=function(){this.SetState(r.INIT)},e.prototype.Play=function(){this.SetState(r.PLAYING)},e.prototype.SpawnRocket=function(t,e){var i=this.GetInactiveRocket();null!=i&&(i.getComponent(s.default).Spawn(t,Math.max(e,15)),this.rocketSpeed+=.5)},e.prototype.SpawnEvil=function(){var t=(c.RandomInt(0,100),1),e=cc.Camera.main.node.position,i=e.x-100,o=e.x+cc.winSize.width+100,n=this.evil.getComponent(a.default);t>0?n.Fly(this.player,t,cc.v3(o,this.player.position.y,0)):n.Fly(this.player,t,cc.v3(i,this.player.position.y,0))},e.prototype.Dead=function(){this.SetState(r.DEAD)},e.prototype.GetInactiveRocket=function(){for(var t=0;t<c.default.ROCKET_MAX;t++){if(this.rockets[t].getComponent(s.default).IsHidden())return this.rockets[t]}return null},n([h({type:cc.Prefab})],e.prototype,"rocketPrefab",void 0),n([h({type:a.default})],e.prototype,"evil",void 0),n([h({type:cc.Node})],e.prototype,"player",void 0),e=n([l],e)}(cc.Component);i.default=f,cc._RF.pop()},{"./Defines":"Defines","./Evil":"Evil","./Rocket":"Rocket","./core/Timer":"Timer"}],Player:[function(t,e,i){"use strict";cc._RF.push(e,"d652cNzqgJBcZvh21QthUXO","Player");var o=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function o(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(o.prototype=i.prototype,new o)}}(),n=this&&this.__decorate||function(t,e,i,o){var n,r=arguments.length,c=r<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,i):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)c=Reflect.decorate(t,e,i,o);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(c=(r<3?n(c):r>3?n(e,i,c):n(e,i))||c);return r>3&&c&&Object.defineProperty(e,i,c),c};Object.defineProperty(i,"__esModule",{value:!0});var r,c,s=t("./Defines"),a=t("./core/EventMgr"),u=t("./Collectible"),p=t("./core/Timer"),l=cc._decorator,h=l.ccclass,f=l.property;(function(t){t[t.INIT=0]="INIT",t[t.TOUCH_TO_PLAY=1]="TOUCH_TO_PLAY",t[t.PLAYING=2]="PLAYING",t[t.PAUSE=3]="PAUSE",t[t.RESUME=4]="RESUME",t[t.WIN=5]="WIN",t[t.LOSE=6]="LOSE"})(r||(r={})),function(t){t.FLY="FLYING_NORMAL",t.HIT="FLYING_HIT"}(c||(c={}));var d=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.spine=null,e.particleHit=null,e.audioHurt=null,e.magnet=null,e.timerGotHit=new p.default,e.timerMagnet=new p.default,e.target=null,e}return o(e,t),e.prototype.start=function(){this.spine.setCompleteListener(this.OnAnimationComplete.bind(this))},e.prototype.update=function(t){switch(this.state){case r.INIT:null!=this.target&&this.node.setPosition(this.node.position.lerp(this.target,.1*s.default.GAME_BASE_SPEED*t));break;case r.TOUCH_TO_PLAY:if(null!=this.target){var e=this.target.add(cc.Camera.main.node.position);this.node.setPosition(this.node.position.lerp(e,.1*s.default.GAME_BASE_SPEED*t))}break;case r.PLAYING:this.startX>cc.winSize.width/3&&(this.startX-=s.default.GAME_BASE_SPEED*t,this.startX<cc.winSize.width/3&&(this.startX=cc.winSize.width/3)),null!=this.target&&this.node.setPosition(this.node.position.lerp(this.target,.1)),this.node.setPosition(cc.Camera.main.node.position.x+this.startX,this.node.position.y),this.timerMagnet.Update(t),this.timerMagnet.JustFinished()&&(this.magnet.enabled=!1);break;case r.WIN:this.startX=cc.misc.lerp(this.startX,2*cc.winSize.width,t/5),this.node.setPosition(this.node.position.lerp(cc.v3(cc.winSize.width/2,cc.winSize.height/2,0),t)),this.node.setPosition(cc.Camera.main.node.position.x+this.startX,this.node.position.y);break;case r.LOSE:this.node.angle=cc.misc.lerp(this.node.angle,-45,2*t),this.node.setPosition(this.node.position.lerp(this.target,t))}this.timerGotHit.Update(t),this.timerGotHit.JustFinished()&&(this.node.opacity=255)},e.prototype.SetState=function(t){switch(this.state=t,t){case r.INIT:this.startX=cc.winSize.width/2,this.node.setPosition(this.startX,cc.winSize.height/2),this.target=this.node.position,this.node.angle=0,this.magnet.enabled=!1;break;case r.PLAYING:case r.PAUSE:break;case r.RESUME:this.state=r.PLAYING;break;case r.WIN:break;case r.LOSE:this.target=cc.v3(this.node.position.x,this.node.position.y-cc.winSize.height,0)}},e.prototype.SetTarget=function(t){this.state!=r.LOSE&&(this.target=t)},e.prototype.EnableMagnet=function(){this.magnet.enabled=!0,this.timerMagnet.SetDuration(10)},e.prototype.DisableMagnet=function(){this.magnet.enabled=!1},e.prototype.Init=function(){this.SetState(r.INIT)},e.prototype.TouchToPlay=function(){this.SetState(r.TOUCH_TO_PLAY)},e.prototype.Play=function(){this.SetState(r.PLAYING)},e.prototype.Pause=function(){this.SetState(r.PAUSE)},e.prototype.Resume=function(){this.SetState(r.RESUME)},e.prototype.Win=function(){this.SetState(r.WIN)},e.prototype.Lose=function(){this.SetState(r.LOSE)},e.prototype.GotHit=function(t){if(this.timerGotHit.IsDone()){for(var e=0;e<this.particleHit.childrenCount;e++){var i=this.particleHit.children[e].getComponent(cc.ParticleSystem);s.RandomInt(0,100)<50&&i.resetSystem()}this.spine.setAnimation(0,c.HIT,!1),this.node.opacity=128,this.timerGotHit.SetDuration(2),this.audioHurt.play(),a.EventMgr.instance.emit(s.GameEvent.PLAYER_HURT,t)}},e.prototype.OnAnimationComplete=function(t){switch(t.animation.name){case c.HIT:this.spine.setAnimation(0,c.FLY,!0)}},e.prototype.onCollisionEnter=function(t,e){if(this.state==r.PLAYING||this.state==r.TOUCH_TO_PLAY)switch(t.tag){case s.CollisionTag.COLLECTIBLE:var i=t.node.getComponent(u.default);e==this.magnet?i.Follow(this):(i.Collect(),a.EventMgr.instance.emit(s.GameEvent.COLLECT_ITEM,i));break;case s.CollisionTag.ROCKET:case s.CollisionTag.EVIL:e!=this.magnet&&this.GotHit(t.tag)}},n([f({type:sp.Skeleton})],e.prototype,"spine",void 0),n([f({type:cc.Node})],e.prototype,"particleHit",void 0),n([f({type:cc.AudioSource})],e.prototype,"audioHurt",void 0),n([f({type:cc.CircleCollider})],e.prototype,"magnet",void 0),e=n([h],e)}(cc.Component);i.default=d,cc._RF.pop()},{"./Collectible":"Collectible","./Defines":"Defines","./core/EventMgr":"EventMgr","./core/Timer":"Timer"}],PopupError:[function(t,e,i){"use strict";cc._RF.push(e,"d4675oSmoFCYbZsUn1UOBSA","PopupError");var o=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function o(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(o.prototype=i.prototype,new o)}}(),n=this&&this.__decorate||function(t,e,i,o){var n,r=arguments.length,c=r<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,i):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)c=Reflect.decorate(t,e,i,o);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(c=(r<3?n(c):r>3?n(e,i,c):n(e,i))||c);return r>3&&c&&Object.defineProperty(e,i,c),c};Object.defineProperty(i,"__esModule",{value:!0});var r=cc._decorator,c=r.ccclass,s=r.property,a=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.sprites=[],e.buttonSprite=null,e.message=null,e}return o(e,t),e.prototype.onEnable=function(){this.node.setScale(.01),cc.tween(this.node).to(.5,{scale:1},{easing:"elasticOut"}).start()},e.prototype.SetMessage=function(t){this.message.string=t},e.prototype.Show=function(t){this.buttonSprite.spriteFrame=this.sprites[t-1],this.node.active=!0},e.prototype.Hide=function(t){cc.tween(this.node).to(.5,{scale:0},{easing:"elasticIn"}).call(t).start()},n([s({type:[cc.SpriteFrame]})],e.prototype,"sprites",void 0),n([s({type:cc.Sprite})],e.prototype,"buttonSprite",void 0),n([s({type:cc.Label})],e.prototype,"message",void 0),e=n([c],e)}(cc.Component);i.default=a,cc._RF.pop()},{}],QRCode:[function(t,e,i){"use strict";cc._RF.push(e,"c0b5cczF6tK2IbZ6VMLWjjz","QRCode");var o=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function o(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(o.prototype=i.prototype,new o)}}(),n=this&&this.__decorate||function(t,e,i,o){var n,r=arguments.length,c=r<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,i):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)c=Reflect.decorate(t,e,i,o);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(c=(r<3?n(c):r>3?n(e,i,c):n(e,i))||c);return r>3&&c&&Object.defineProperty(e,i,c),c};Object.defineProperty(i,"__esModule",{value:!0});var r=t("../Defines"),c=t("./Timer"),s=t("../API"),a=cc._decorator,u=a.ccclass,p=(a.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.timer=new c.default,e}return o(e,t),e.prototype.onLoad=function(){this.ctx=this.node.addComponent(cc.Graphics),this.UpdateParams()},e.prototype.update=function(t){this.timer.Update(t),this.timer.JustFinished()&&this.RefreshQR(r.default.QR_REFRESH_RATE)},e.prototype.ParseUrl=function(t){for(var e,i=/[?&]([^=#]+)=([^&#]*)/g,o={};e=i.exec(t);)o[e[1]]=decodeURIComponent(e[2]);return o},e.prototype.UpdateParams=function(){var t=window.userParams,e=this.ParseUrl(window.location.href);Object.keys(e).forEach(function(i){t[i]=e[i]}),t.landing+="?gc="+(t.gc||1)+"&ch="+(t.ch||1)+"&location="+(t.location||"vanhanhmall")+"&t={t}"},e.prototype.CreateQR=function(t){var e=new qrcode(-1,"L");e.addData(t),e.make(),this.ctx.fillColor=cc.Color.WHITE,this.ctx.rect(-this.node.width/2,-this.node.height/2,this.node.width,this.node.height),this.ctx.fill();for(var i=this.node.width/e.getModuleCount(),o=this.node.height/e.getModuleCount(),n=0;n<e.getModuleCount();n++)for(var r=0;r<e.getModuleCount();r++)if(e.isDark(n,r)){var c=Math.ceil((r+1)*i)-Math.floor(r*i),s=Math.ceil((n+1)*i)-Math.floor(n*i);this.ctx.fillColor=cc.Color.BLACK,this.ctx.rect(Math.round(r*i)-this.node.width/2,Math.round(n*o)-this.node.height/2,c,s),this.ctx.fill()}},e.prototype.RefreshQR=function(t){var e=this;s.default.GetTime().then(function(i){var o=JSON.parse(i),n=window.userParams.landing.replace("{t}",o.timeStamp);e.CreateQR(n),e.timer.SetDuration(t)}).catch(function(t){e.timer.SetDuration(5)})},e=n([u],e)}(cc.Component));i.default=p,cc._RF.pop()},{"../API":"API","../Defines":"Defines","./Timer":"Timer"}],Rocket:[function(t,e,i){"use strict";cc._RF.push(e,"28b21mB0itJ/JOyGv7GOWG9","Rocket");var o=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function o(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(o.prototype=i.prototype,new o)}}(),n=this&&this.__decorate||function(t,e,i,o){var n,r=arguments.length,c=r<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,i):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)c=Reflect.decorate(t,e,i,o);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(c=(r<3?n(c):r>3?n(e,i,c):n(e,i))||c);return r>3&&c&&Object.defineProperty(e,i,c),c};Object.defineProperty(i,"__esModule",{value:!0});var r,c=t("./Defines"),s=t("./core/Timer"),a=cc._decorator,u=a.ccclass,p=a.property;(function(t){t[t.ALARM=0]="ALARM",t[t.FIRE=1]="FIRE",t[t.PLAYING=2]="PLAYING",t[t.HIDE=3]="HIDE"})(r||(r={}));var l=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.alarm=null,e.rocket=null,e.audioAlarm=null,e.audioFire=null,e.timerAlarm=new s.default,e.speed=0,e.isExploded=!1,e}return o(e,t),e.prototype.update=function(t){var e=cc.Camera.main.node.position;switch(this.state){case r.ALARM:this.node.setPosition(cc.winSize.width-100+e.x,this.node.position.y),this.timerAlarm.Update(t),this.timerAlarm.IsDone()&&this.Fire(e.x);break;case r.PLAYING:this.node.setPosition(this.node.position.subtract(cc.v3(this.speed*c.default.GAME_BASE_SPEED*t,0,0))),this.node.position.x-e.x<-cc.winSize.width&&this.SetState(r.HIDE);break;case r.HIDE:}},e.prototype.onExploded=function(){this.node.active=!1},e.prototype.SetState=function(t){switch(this.state=t,t){case r.ALARM:this.isExploded=!1,this.alarm.active=!0,this.rocket.active=!1,this.node.active=!0,this.audioAlarm.play(),this.timerAlarm.SetDuration(1);break;case r.FIRE:this.alarm.active=!1,this.rocket.active=!0,this.audioFire.play(),this.SetState(r.PLAYING);break;case r.PLAYING:this.node.active=!0;break;case r.HIDE:this.node.active=!1}},e.prototype.Spawn=function(t,e){void 0===e&&(e=0),this.speed=e,this.node.setPosition(0,t),this.SetState(r.ALARM)},e.prototype.Fire=function(t){this.node.setPosition(t+cc.winSize.width+200,this.node.position.y),this.SetState(r.FIRE)},e.prototype.Explode=function(){this.isExploded=!0},e.prototype.Hide=function(){this.isExploded||(this.node.active=!1)},e.prototype.IsHidden=function(){return!this.node.active},n([p({type:cc.Node})],e.prototype,"alarm",void 0),n([p({type:cc.Node})],e.prototype,"rocket",void 0),n([p({type:cc.AudioSource})],e.prototype,"audioAlarm",void 0),n([p({type:cc.AudioSource})],e.prototype,"audioFire",void 0),e=n([u],e)}(cc.Component);i.default=l,cc._RF.pop()},{"./Defines":"Defines","./core/Timer":"Timer"}],Score:[function(t,e,i){"use strict";cc._RF.push(e,"4b8dbx0F+1EK4gLUoDKA4c0","Score");var o=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function o(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(o.prototype=i.prototype,new o)}}(),n=this&&this.__decorate||function(t,e,i,o){var n,r=arguments.length,c=r<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,i):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)c=Reflect.decorate(t,e,i,o);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(c=(r<3?n(c):r>3?n(e,i,c):n(e,i))||c);return r>3&&c&&Object.defineProperty(e,i,c),c};Object.defineProperty(i,"__esModule",{value:!0});var r=t("../Defines"),c=t("../core/Timer"),s=cc._decorator,a=s.ccclass,u=s.property,p=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.score=null,e.win=null,e.lose=null,e.winMessage=null,e.loseMessage=null,e.timerHide=null,e}return o(e,t),e.prototype.onEnable=function(){this.node.opacity=0,cc.tween(this.node).to(.5,{opacity:255},{easing:"sineIn"}).start()},e.prototype.update=function(t){null!=this.timerHide&&(this.timerHide.Update(t),this.timerHide.JustFinished()&&this.Hide(this.callback))},e.prototype.SetWin=function(t,e,i){void 0===i&&(i=null),this.win.active=!0,this.lose.active=!1,this.score.string=""+t,this.winMessage.string=null!=e?e:"",this.callback=i,this.timerHide=new c.default,this.timerHide.SetDuration(r.default.GAME_RESULT_TIMEOUT)},e.prototype.SetLose=function(t,e){void 0===e&&(e=null),this.win.active=!1,this.lose.active=!0,this.loseMessage.string=t,this.callback=e,this.timerHide=new c.default,this.timerHide.SetDuration(r.default.GAME_RESULT_TIMEOUT)},e.prototype.Hide=function(t){var e=this;cc.tween(this.node).to(.5,{opacity:0},{easing:"sineIn"}).call(function(){null!=t&&t(),e.node.active=!1}).start()},n([u({type:cc.Label})],e.prototype,"score",void 0),n([u({type:cc.Node})],e.prototype,"win",void 0),n([u({type:cc.Node})],e.prototype,"lose",void 0),n([u({type:cc.Label})],e.prototype,"winMessage",void 0),n([u({type:cc.Label})],e.prototype,"loseMessage",void 0),e=n([a],e)}(cc.Component);i.default=p,cc._RF.pop()},{"../Defines":"Defines","../core/Timer":"Timer"}],Scrollable:[function(t,e,i){"use strict";cc._RF.push(e,"57b7aKPTL1GaKtvIwp9ztlP","Scrollable");var o=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function o(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(o.prototype=i.prototype,new o)}}(),n=this&&this.__decorate||function(t,e,i,o){var n,r=arguments.length,c=r<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,i):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)c=Reflect.decorate(t,e,i,o);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(c=(r<3?n(c):r>3?n(e,i,c):n(e,i))||c);return r>3&&c&&Object.defineProperty(e,i,c),c};Object.defineProperty(i,"__esModule",{value:!0});var r,c=t("./Defines"),s=cc._decorator,a=s.ccclass,u=s.property;(function(t){t[t.INIT=0]="INIT",t[t.PLAYING=1]="PLAYING",t[t.PAUSE=2]="PAUSE",t[t.DEAD=3]="DEAD"})(r||(r={}));var p=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.sprites=[],e.speed=0,e.overlapOffset=2,e}return o(e,t),e.prototype.onLoad=function(){},e.prototype.start=function(){},e.prototype.update=function(t){switch(this.state){case r.INIT:break;case r.PLAYING:for(var e=cc.Camera.main.node.position,i=0;i<this.sprites.length;i++)e.x-this.sprites[i].position.x-this.node.position.x>=this.sprites[i].width-this.overlapOffset&&(this.sprites[i].setPosition(this.sprites[this.lastIndex].position.x+this.sprites[this.lastIndex].width-this.overlapOffset,this.sprites[i].position.y),this.lastIndex++,this.lastIndex==this.sprites.length&&(this.lastIndex=0));this.node.setPosition(this.node.position.x+this.speed*c.default.GAME_BASE_SPEED*t,this.node.position.y);break;case r.DEAD:}},e.prototype.SetState=function(t){switch(this.state=t,t){case r.INIT:for(var e=0,i=0;i<this.sprites.length;i++)this.sprites[i].setPosition(e,this.sprites[i].position.y),e+=this.sprites[i].width-this.overlapOffset;this.lastIndex=this.sprites.length-1,this.node.setPosition(0,this.node.position.y);break;case r.PLAYING:case r.DEAD:}},e.prototype.SetTheme=function(t){for(var e=0;e<this.sprites.length;e++)this.sprites[e].getComponent(cc.Sprite).spriteFrame=t[e]},e.prototype.Init=function(){this.SetState(r.INIT)},e.prototype.Play=function(){this.SetState(r.PLAYING)},e.prototype.Dead=function(){this.SetState(r.DEAD)},e.prototype.Pause=function(){this.SetState(r.PAUSE)},e.prototype.Resume=function(){this.state=r.PLAYING},n([u({type:[cc.Node]})],e.prototype,"sprites",void 0),n([u({type:cc.Float})],e.prototype,"speed",void 0),e=n([a],e)}(cc.Component);i.default=p,cc._RF.pop()},{"./Defines":"Defines"}],Settings:[function(t,e,i){"use strict";cc._RF.push(e,"407108dGK9E7Zg4Zj6ToW2S","Settings"),Object.defineProperty(i,"__esModule",{value:!0}),i.default=new(function(){return function(){this.useSound=!0}}()),cc._RF.pop()},{}],SimpleFaceDetect:[function(t,e,i){"use strict";cc._RF.push(e,"03f518hEaRAnaBCBt2xkN8Y","SimpleFaceDetect"),Object.defineProperty(i,"__esModule",{value:!0}),i.default=new(function(){function t(){}return t.prototype.Init=function(){var t=window.pico,e=t.instantiate_detection_memory(5),i=function(t,e,i,o,n){return-1};fetch("libs/picojs/models/facefinder").then(function(e){e.arrayBuffer().then(function(e){var o=new Int8Array(e);i=t.unpack_cascade(o),console.log("* facefinder loaded")})});var o=document.getElementById("VideoCanvas"),n=o.getContext("2d");function r(t,e,i){for(var o=new Uint8Array(e*i),n=0;n<e;++n)for(var r=0;r<i;++r)o[n*i+r]=(2*t[4*n*i+4*r+0]+7*t[4*n*i+4*r+1]+1*t[4*n*i+4*r+2])/10;return o}return function(c,s){var a={x:0,y:0,width:c.videoWidth,height:c.videoHeight};if(a.width>0&&a.height>0){var u={pixels:r(n.getImageData(a.x,a.y,a.width,a.height).data,a.width,a.height),nrows:a.height,ncols:a.width,ldim:a.width},p=t.run_cascade(u,i,{shiftfactor:.1,minsize:100,maxsize:500,scalefactor:1.1});p=e(p),p=t.cluster_detections(p,.2);for(var l=0;l<p.length;++l)p[l][3]>50&&s({x:p[l][1]*cc.winSize.width/o.width,y:p[l][0]*cc.winSize.height/o.height})}}},t}()),cc._RF.pop()},{}],Timer:[function(t,e,i){"use strict";cc._RF.push(e,"6b85cbHB39ATpO/QtAEphQG","Timer"),Object.defineProperty(i,"__esModule",{value:!0});var o=function(){function t(){this.timer=0,this.duration=0,this.overhead=0,this.isDone=!0}return t.prototype.SetDuration=function(t){this.timer=this.duration=t,this.overhead=0,this.isDone=!1},t.prototype.AddTime=function(t){this.timer+=t,this.overhead=0,this.isDone=!1},t.prototype.GetTime=function(){return this.timer},t.prototype.GetTimePercent=function(){return this.timer/this.duration},t.prototype.Reset=function(){this.timer=this.duration,this.overhead=0,this.isDone=!1},t.prototype.IsDone=function(){return 0==this.timer},t.prototype.JustFinished=function(){return!(this.timer>0)&&(!this.isDone&&(this.isDone=!0,!0))},t.prototype.Update=function(t){0!=this.timer&&(this.timer-=t,this.timer<0&&(this.overhead=-this.timer,this.timer=0))},t}();i.default=o,cc._RF.pop()},{}],VideoCamera:[function(t,e,i){"use strict";cc._RF.push(e,"5ee6ceeKBRDX7drvjupA0Ys","VideoCamera");var o=this&&this.__awaiter||function(t,e,i,o){function n(t){return t instanceof i?t:new i(function(e){e(t)})}return new(i||(i=Promise))(function(i,r){function c(t){try{a(o.next(t))}catch(t){r(t)}}function s(t){try{a(o.throw(t))}catch(t){r(t)}}function a(t){t.done?i(t.value):n(t.value).then(c,s)}a((o=o.apply(t,e||[])).next())})},n=this&&this.__generator||function(t,e){var i,o,n,r,c={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return r={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function s(t){return function(e){return a([t,e])}}function a(r){if(i)throw new TypeError("Generator is already executing.");for(;c;)try{if(i=1,o&&(n=2&r[0]?o.return:r[0]?o.throw||((n=o.return)&&n.call(o),0):o.next)&&!(n=n.call(o,r[1])).done)return n;switch(o=0,n&&(r=[2&r[0],n.value]),r[0]){case 0:case 1:n=r;break;case 4:return c.label++,{value:r[1],done:!1};case 5:c.label++,o=r[1],r=[0];continue;case 7:r=c.ops.pop(),c.trys.pop();continue;default:if(!(n=(n=c.trys).length>0&&n[n.length-1])&&(6===r[0]||2===r[0])){c=0;continue}if(3===r[0]&&(!n||r[1]>n[0]&&r[1]<n[3])){c.label=r[1];break}if(6===r[0]&&c.label<n[1]){c.label=n[1],n=r;break}if(n&&c.label<n[2]){c.label=n[2],c.ops.push(r);break}n[2]&&c.ops.pop(),c.trys.pop();continue}r=e.call(t,c)}catch(t){r=[6,t],o=0}finally{i=n=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}};Object.defineProperty(i,"__esModule",{value:!0});var r=function(){function t(){this.isPortrait=window.innerWidth<window.innerHeight}return t.prototype.Setup=function(t){return o(this,void 0,void 0,function(){var e,i,o;return n(this,function(n){switch(n.label){case 0:if(!navigator.mediaDevices||!navigator.mediaDevices.getUserMedia)throw new Error("Browser API navigator.mediaDevices.getUserMedia not available");return e=document.getElementById("Video"),i={audio:!1,video:{facingMode:"user"}},t||(this.isPortrait?(i.video.width=1080,i.video.height=1920):(i.video.width=1920,i.video.height=1080)),[4,navigator.mediaDevices.getUserMedia(i)];case 1:return o=n.sent(),e.srcObject=o,e.style.display="none",e.setAttribute("webkit-playsinline",""),e.setAttribute("playsinline","playsinline"),e.setAttribute("muted",""),this.canvas=document.getElementById("VideoCanvas"),this.context=this.canvas.getContext("2d"),[2,new Promise(function(t,i){e.onloadedmetadata=function(){t(e)}})]}})})},t.prototype.Init=function(t){return o(this,void 0,void 0,function(){var e;return n(this,function(i){switch(i.label){case 0:return[4,this.Setup(t)];case 1:return(e=i.sent()).play(),[2,e]}})})},t.prototype.Render=function(t){var e={x:0,y:0,width:t.videoWidth,height:t.videoHeight};if(this.isPortrait)this.canvas.width=e.width,this.canvas.height=e.height,this.context.drawImage(t,0,0);else{var i=e.width/window.innerWidth;this.canvas.width=e.width,this.canvas.height=Math.round(window.innerHeight*i),t.width=e.width,t.height=e.height;var o=(this.canvas.height-e.height)/2;this.context.rect(0,0,this.canvas.width,this.canvas.height),this.context.clip(),this.context.drawImage(t,0,0,e.width,e.height,0,o,e.width,e.height)}},t}();i.default=r,cc._RF.pop()},{}]},{},["API","Collectible","CollectibleMgr","Defines","Evil","GameMgr","Init","Message","ObstacleMgr","Player","Rocket","Scrollable","Settings","SimpleFaceDetect","VideoCamera","EventMgr","Input","QRCode","Timer","ML5Wrapper","Ingame","Loading","MainMenu","PopupError","Score"]);